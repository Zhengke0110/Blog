import{_ as t}from"./Post.dd5dd46a.js";import{u as c,c as r,w as i,o as d,a,b as n}from"./app.038d67a7.js";const f="Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E",b="2025-09-28T00:00:00.000Z",g="notes",_=[{property:"og:title",content:"Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E"}],v={__name:"docker-dify",setup(p,{expose:s}){const e={title:"Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E",date:"2025-09-28T00:00:00.000Z",type:"notes",meta:[{property:"og:title",content:"Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E"}]};return s({frontmatter:e}),c({title:"Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E",meta:[{property:"og:title",content:"Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E"}]}),(h,l)=>{const o=t;return d(),r(o,{frontmatter:e},{default:i(()=>[...l[0]||(l[0]=[a("div",{class:"prose m-auto"},[a("h2",{id:"\u95EE\u9898\u80CC\u666F",tabindex:"-1"},[n("\u95EE\u9898\u80CC\u666F "),a("a",{class:"header-anchor",href:"#\u95EE\u9898\u80CC\u666F","aria-hidden":"true"},"#")]),a("p",null,"\u5728\u4F7F\u7528 Docker \u90E8\u7F72 Dify \u65F6\u9047\u5230 Ollama \u8FDE\u63A5\u9519\u8BEF\uFF1A"),a("pre",null,[a("code",null,`HTTPConnectionPool(host='127.0.0.1', port=11434): Max retries exceeded with url: /api/chat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff985bd670>: Failed to establish a new connection: [Errno 111] Connection refused'))
`)]),a("h2",{id:"\u95EE\u9898\u539F\u56E0",tabindex:"-1"},[n("\u95EE\u9898\u539F\u56E0 "),a("a",{class:"header-anchor",href:"#\u95EE\u9898\u539F\u56E0","aria-hidden":"true"},"#")]),a("p",null,[n("Docker \u5BB9\u5668\u5185\u90E8\u65E0\u6CD5\u901A\u8FC7 "),a("code",null,"127.0.0.1:11434"),n(" \u8BBF\u95EE\u5BBF\u4E3B\u673A\u4E0A\u8FD0\u884C\u7684 Ollama \u670D\u52A1\u3002\u9700\u8981\u4F7F\u7528 "),a("code",null,"host.docker.internal:11434"),n(" \u6765\u8BBF\u95EE\u5BBF\u4E3B\u673A\u670D\u52A1\u3002")]),a("h2",{id:"\u89E3\u51B3\u6B65\u9AA4",tabindex:"-1"},[n("\u89E3\u51B3\u6B65\u9AA4 "),a("a",{class:"header-anchor",href:"#\u89E3\u51B3\u6B65\u9AA4","aria-hidden":"true"},"#")]),a("h3",{id:"_1-\u68C0\u67E5-ollama-\u670D\u52A1\u72B6\u6001",tabindex:"-1"},[n("1. \u68C0\u67E5 Ollama \u670D\u52A1\u72B6\u6001 "),a("a",{class:"header-anchor",href:"#_1-\u68C0\u67E5-ollama-\u670D\u52A1\u72B6\u6001","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u68C0\u67E5Ollama\u8FDB\u7A0B\u662F\u5426\u8FD0\u884C"),n(`
`),a("span",{class:"token function"},"ps"),n(" aux "),a("span",{class:"token operator"},"|"),n(),a("span",{class:"token function"},"grep"),n(` ollama

`),a("span",{class:"token comment"},"# \u68C0\u67E5\u7AEF\u53E311434\u662F\u5426\u88AB\u5360\u7528"),n(`
`),a("span",{class:"token function"},"lsof"),n(),a("span",{class:"token parameter variable"},"-i"),n(` :11434

`),a("span",{class:"token comment"},"# \u6D4B\u8BD5Ollama API\u8FDE\u63A5"),n(`
`),a("span",{class:"token function"},"curl"),n(),a("span",{class:"token parameter variable"},"-s"),n(` http://127.0.0.1:11434/api/version
`)])]),a("h3",{id:"_2-\u521B\u5EFA\u73AF\u5883\u914D\u7F6E\u6587\u4EF6",tabindex:"-1"},[n("2. \u521B\u5EFA\u73AF\u5883\u914D\u7F6E\u6587\u4EF6 "),a("a",{class:"header-anchor",href:"#_2-\u521B\u5EFA\u73AF\u5883\u914D\u7F6E\u6587\u4EF6","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u8FDB\u5165Dify\u9879\u76EE\u76EE\u5F55"),n(`
`),a("span",{class:"token builtin class-name"},"cd"),n(` /Users/zhengke/Downloads/dify/dify-docker

`),a("span",{class:"token comment"},"# \u590D\u5236\u793A\u4F8B\u914D\u7F6E\u6587\u4EF6"),n(`
`),a("span",{class:"token function"},"cp"),n(` .env.example .env
`)])]),a("h3",{id:"_3-\u4FEE\u6539-ollama-\u914D\u7F6E",tabindex:"-1"},[n("3. \u4FEE\u6539 Ollama \u914D\u7F6E "),a("a",{class:"header-anchor",href:"#_3-\u4FEE\u6539-ollama-\u914D\u7F6E","aria-hidden":"true"},"#")]),a("p",null,[n("\u7F16\u8F91 "),a("code",null,".env"),n(" \u6587\u4EF6\uFF0C\u4FEE\u6539 "),a("code",null,"OPENAI_API_BASE"),n(" \u914D\u7F6E\uFF1A")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u539F\u914D\u7F6E"),n(`
`),a("span",{class:"token assign-left variable"},"OPENAI_API_BASE"),a("span",{class:"token operator"},"="),n(`https://api.openai.com/v1

`),a("span",{class:"token comment"},"# \u4FEE\u6539\u4E3A"),n(`
`),a("span",{class:"token assign-left variable"},"OPENAI_API_BASE"),a("span",{class:"token operator"},"="),n(`http://host.docker.internal:11434/v1
`)])]),a("h3",{id:"_4-\u91CD\u542F-docker-\u5BB9\u5668",tabindex:"-1"},[n("4. \u91CD\u542F Docker \u5BB9\u5668 "),a("a",{class:"header-anchor",href:"#_4-\u91CD\u542F-docker-\u5BB9\u5668","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u505C\u6B62\u6240\u6709\u5BB9\u5668"),n(`
`),a("span",{class:"token function"},"docker-compose"),n(` down

`),a("span",{class:"token comment"},"# \u542F\u52A8\u6240\u6709\u5BB9\u5668"),n(`
`),a("span",{class:"token function"},"docker-compose"),n(" up "),a("span",{class:"token parameter variable"},"-d"),n(`
`)])]),a("h3",{id:"_5-\u9A8C\u8BC1\u914D\u7F6E",tabindex:"-1"},[n("5. \u9A8C\u8BC1\u914D\u7F6E "),a("a",{class:"header-anchor",href:"#_5-\u9A8C\u8BC1\u914D\u7F6E","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u6D4B\u8BD5\u5BB9\u5668\u5185\u662F\u5426\u80FD\u8BBF\u95EEOllama"),n(`
`),a("span",{class:"token function"},"docker"),n(),a("span",{class:"token builtin class-name"},"exec"),n(),a("span",{class:"token parameter variable"},"-it"),n(" dify-docker-api-1 "),a("span",{class:"token function"},"curl"),n(),a("span",{class:"token parameter variable"},"-s"),n(` http://host.docker.internal:11434/api/version

`),a("span",{class:"token comment"},"# \u68C0\u67E5\u73AF\u5883\u53D8\u91CF\u662F\u5426\u6B63\u786E\u8BBE\u7F6E"),n(`
`),a("span",{class:"token function"},"docker"),n(),a("span",{class:"token builtin class-name"},"exec"),n(" dify-docker-api-1 "),a("span",{class:"token function"},"env"),n(),a("span",{class:"token operator"},"|"),n(),a("span",{class:"token function"},"grep"),n(` OPENAI_API_BASE

`),a("span",{class:"token comment"},"# \u67E5\u770BAPI\u5BB9\u5668\u65E5\u5FD7"),n(`
`),a("span",{class:"token function"},"docker"),n(" logs dify-docker-api-1 "),a("span",{class:"token parameter variable"},"--tail"),n(),a("span",{class:"token number"},"20"),n(`
`)])]),a("h2",{id:"\u5173\u952E\u914D\u7F6E\u8BF4\u660E",tabindex:"-1"},[n("\u5173\u952E\u914D\u7F6E\u8BF4\u660E "),a("a",{class:"header-anchor",href:"#\u5173\u952E\u914D\u7F6E\u8BF4\u660E","aria-hidden":"true"},"#")]),a("h3",{id:"docker-\u7F51\u7EDC\u8BBF\u95EE",tabindex:"-1"},[n("Docker \u7F51\u7EDC\u8BBF\u95EE "),a("a",{class:"header-anchor",href:"#docker-\u7F51\u7EDC\u8BBF\u95EE","aria-hidden":"true"},"#")]),a("ul",null,[a("li",null,[a("strong",null,"\u5BB9\u5668\u5185\u8BBF\u95EE\u5BBF\u4E3B\u673A"),n(": \u4F7F\u7528 "),a("code",null,"host.docker.internal"),n(" \u66FF\u4EE3 "),a("code",null,"127.0.0.1"),n(" \u6216 "),a("code",null,"localhost")]),a("li",null,[a("strong",null,"\u7AEF\u53E3\u6620\u5C04"),n(": Ollama \u9ED8\u8BA4\u76D1\u542C "),a("code",null,"11434"),n(" \u7AEF\u53E3")]),a("li",null,[a("strong",null,"API \u517C\u5BB9\u6027"),n(": Ollama \u63D0\u4F9B OpenAI \u517C\u5BB9\u7684 API \u7AEF\u70B9 "),a("code",null,"/v1")])]),a("h3",{id:"\u73AF\u5883\u53D8\u91CF\u914D\u7F6E",tabindex:"-1"},[n("\u73AF\u5883\u53D8\u91CF\u914D\u7F6E "),a("a",{class:"header-anchor",href:"#\u73AF\u5883\u53D8\u91CF\u914D\u7F6E","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u5173\u952E\u73AF\u5883\u53D8\u91CF"),n(`
`),a("span",{class:"token assign-left variable"},"OPENAI_API_BASE"),a("span",{class:"token operator"},"="),n(`http://host.docker.internal:11434/v1

`),a("span",{class:"token comment"},"# \u5176\u4ED6\u91CD\u8981\u914D\u7F6E"),n(`
`),a("span",{class:"token assign-left variable"},"VECTOR_STORE"),a("span",{class:"token operator"},"="),n("weaviate  "),a("span",{class:"token comment"},"# \u5411\u91CF\u6570\u636E\u5E93\u9009\u62E9"),n(`
`),a("span",{class:"token assign-left variable"},"DB_USERNAME"),a("span",{class:"token operator"},"="),n("postgres   "),a("span",{class:"token comment"},"# \u6570\u636E\u5E93\u7528\u6237\u540D"),n(`
`),a("span",{class:"token assign-left variable"},"DB_PASSWORD"),a("span",{class:"token operator"},"="),n("difyai123456  "),a("span",{class:"token comment"},"# \u6570\u636E\u5E93\u5BC6\u7801"),n(`
`),a("span",{class:"token assign-left variable"},"REDIS_PASSWORD"),a("span",{class:"token operator"},"="),n("difyai123456  "),a("span",{class:"token comment"},"# Redis\u5BC6\u7801"),n(`
`)])]),a("h3",{id:"docker-compose-\u670D\u52A1",tabindex:"-1"},[n("Docker Compose \u670D\u52A1 "),a("a",{class:"header-anchor",href:"#docker-compose-\u670D\u52A1","aria-hidden":"true"},"#")]),a("p",null,"\u4E3B\u8981\u670D\u52A1\u5305\u62EC\uFF1A"),a("ul",null,[a("li",null,[a("code",null,"api"),n(": Dify API \u670D\u52A1")]),a("li",null,[a("code",null,"worker"),n(": \u961F\u5217\u5904\u7406\u670D\u52A1")]),a("li",null,[a("code",null,"web"),n(": \u524D\u7AEF Web \u754C\u9762")]),a("li",null,[a("code",null,"db"),n(": PostgreSQL \u6570\u636E\u5E93")]),a("li",null,[a("code",null,"redis"),n(": Redis \u7F13\u5B58")]),a("li",null,[a("code",null,"weaviate"),n(": \u5411\u91CF\u6570\u636E\u5E93")]),a("li",null,[a("code",null,"sandbox"),n(": \u4EE3\u7801\u6267\u884C\u6C99\u76D2")]),a("li",null,[a("code",null,"nginx"),n(": \u53CD\u5411\u4EE3\u7406")])]),a("h2",{id:"\u6545\u969C\u6392\u67E5\u6307\u5357",tabindex:"-1"},[n("\u6545\u969C\u6392\u67E5\u6307\u5357 "),a("a",{class:"header-anchor",href:"#\u6545\u969C\u6392\u67E5\u6307\u5357","aria-hidden":"true"},"#")]),a("h3",{id:"_1-\u68C0\u67E5\u670D\u52A1\u72B6\u6001",tabindex:"-1"},[n("1. \u68C0\u67E5\u670D\u52A1\u72B6\u6001 "),a("a",{class:"header-anchor",href:"#_1-\u68C0\u67E5\u670D\u52A1\u72B6\u6001","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u67E5\u770B\u6240\u6709\u5BB9\u5668\u72B6\u6001"),n(`
`),a("span",{class:"token function"},"docker-compose"),n(),a("span",{class:"token function"},"ps"),n(`

`),a("span",{class:"token comment"},"# \u67E5\u770B\u7279\u5B9A\u5BB9\u5668\u65E5\u5FD7"),n(`
`),a("span",{class:"token function"},"docker"),n(` logs dify-docker-api-1
`),a("span",{class:"token function"},"docker"),n(` logs dify-docker-worker-1
`),a("span",{class:"token function"},"docker"),n(` logs dify-docker-nginx-1
`)])]),a("h3",{id:"_2-\u7F51\u7EDC\u8FDE\u901A\u6027\u6D4B\u8BD5",tabindex:"-1"},[n("2. \u7F51\u7EDC\u8FDE\u901A\u6027\u6D4B\u8BD5 "),a("a",{class:"header-anchor",href:"#_2-\u7F51\u7EDC\u8FDE\u901A\u6027\u6D4B\u8BD5","aria-hidden":"true"},"#")]),a("pre",{class:"language-bash"},[a("code",{class:"language-bash"},[a("span",{class:"token comment"},"# \u4ECE\u5BB9\u5668\u5185\u6D4B\u8BD5\u8FDE\u63A5"),n(`
`),a("span",{class:"token function"},"docker"),n(),a("span",{class:"token builtin class-name"},"exec"),n(),a("span",{class:"token parameter variable"},"-it"),n(" dify-docker-api-1 "),a("span",{class:"token function"},"curl"),n(),a("span",{class:"token parameter variable"},"-v"),n(` http://host.docker.internal:11434/api/version

`),a("span",{class:"token comment"},"# \u6D4B\u8BD5Dify Web\u754C\u9762"),n(`
`),a("span",{class:"token function"},"curl"),n(),a("span",{class:"token parameter variable"},"-s"),n(),a("span",{class:"token parameter variable"},"-o"),n(" /dev/null "),a("span",{class:"token parameter variable"},"-w"),n(),a("span",{class:"token string"},'"%{http_code}"'),n(` http://localhost
`)])]),a("h3",{id:"_3-\u5E38\u89C1\u95EE\u9898",tabindex:"-1"},[n("3. \u5E38\u89C1\u95EE\u9898 "),a("a",{class:"header-anchor",href:"#_3-\u5E38\u89C1\u95EE\u9898","aria-hidden":"true"},"#")]),a("ol",null,[a("li",null,[a("strong",null,"\u7AEF\u53E3\u51B2\u7A81"),n(": \u786E\u4FDD 80\u3001443\u30015001 \u7B49\u7AEF\u53E3\u672A\u88AB\u5360\u7528")]),a("li",null,[a("strong",null,"\u5185\u5B58\u4E0D\u8DB3"),n(": \u786E\u4FDD\u7CFB\u7EDF\u6709\u8DB3\u591F\u5185\u5B58\u8FD0\u884C\u6240\u6709\u670D\u52A1")]),a("li",null,[a("strong",null,"\u6743\u9650\u95EE\u9898"),n(": \u786E\u4FDD Docker \u6709\u8DB3\u591F\u6743\u9650\u8BBF\u95EE\u6302\u8F7D\u76EE\u5F55")])]),a("h2",{id:"\u8BBF\u95EE\u5730\u5740",tabindex:"-1"},[n("\u8BBF\u95EE\u5730\u5740 "),a("a",{class:"header-anchor",href:"#\u8BBF\u95EE\u5730\u5740","aria-hidden":"true"},"#")]),a("ul",null,[a("li",null,[a("strong",null,"Dify Web \u754C\u9762"),n(": "),a("a",{href:"http://localhost",target:"_blank",rel:"noopener"},"http://localhost")]),a("li",null,[a("strong",null,"API \u6587\u6863"),n(": "),a("a",{href:"http://localhost/swagger-ui.html",target:"_blank",rel:"noopener"},"http://localhost/swagger-ui.html")]),a("li",null,[a("strong",null,"Ollama API"),n(": "),a("a",{href:"http://localhost:11434",target:"_blank",rel:"noopener"},"http://localhost:11434")])]),a("h2",{id:"\u6CE8\u610F\u4E8B\u9879",tabindex:"-1"},[n("\u6CE8\u610F\u4E8B\u9879 "),a("a",{class:"header-anchor",href:"#\u6CE8\u610F\u4E8B\u9879","aria-hidden":"true"},"#")]),a("ol",null,[a("li",null,"\u9996\u6B21\u542F\u52A8\u53EF\u80FD\u9700\u8981\u51E0\u5206\u949F\u65F6\u95F4\u521D\u59CB\u5316\u6570\u636E\u5E93"),a("li",null,"\u786E\u4FDD Ollama \u670D\u52A1\u5728 Dify \u542F\u52A8\u524D\u5DF2\u7ECF\u8FD0\u884C"),a("li",null,"\u751F\u4EA7\u73AF\u5883\u5EFA\u8BAE\u4FEE\u6539\u9ED8\u8BA4\u5BC6\u7801\u548C\u5BC6\u94A5"),a("li",null,"\u5B9A\u671F\u5907\u4EFD\u6570\u636E\u5E93\u548C\u5B58\u50A8\u5377")]),a("h2",{id:"\u76F8\u5173\u6587\u4EF6",tabindex:"-1"},[n("\u76F8\u5173\u6587\u4EF6 "),a("a",{class:"header-anchor",href:"#\u76F8\u5173\u6587\u4EF6","aria-hidden":"true"},"#")]),a("ul",null,[a("li",null,[a("code",null,"docker-compose.yaml"),n(": Docker \u670D\u52A1\u7F16\u6392\u914D\u7F6E")]),a("li",null,[a("code",null,".env"),n(": \u73AF\u5883\u53D8\u91CF\u914D\u7F6E")]),a("li",null,[a("code",null,"volumes/"),n(": \u6570\u636E\u6301\u4E45\u5316\u76EE\u5F55")])]),a("hr"),a("p",null,[a("em",null,"\u521B\u5EFA\u65F6\u95F4: 2025 \u5E74 9 \u6708 28 \u65E5"),a("em",null,"\u95EE\u9898\u89E3\u51B3: Docker \u5BB9\u5668\u8BBF\u95EE\u5BBF\u4E3B\u673A Ollama \u670D\u52A1\u914D\u7F6E")])],-1)])]),_:1})}}};export{b as date,v as default,_ as meta,f as title,g as type};
