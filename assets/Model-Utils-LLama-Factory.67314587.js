import{_ as o}from"./Post.14d9d5ce.js";import{u as r,c as p,w as c,o as u,a as n,b as a}from"./app.95384a36.js";var i="/images/notes/llm/Model-LLama-Factory/webui_0.png",k="/images/notes/llm/Model-LLama-Factory/e8562063755c3400238149c2217c1559.png";const b="LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6",y="2025-08-14T00:00:00.000Z",f="llm",L=[{property:"og:title",content:"LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6"}],x={__name:"Model-Utils-LLama-Factory",setup(d,{expose:e}){const s={title:"LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6",date:"2025-08-14T00:00:00.000Z",type:"llm",meta:[{property:"og:title",content:"LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6"}]};return e({frontmatter:s}),r({title:"LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6",meta:[{property:"og:title",content:"LLaMA Factory\uFF1A\u9AD8\u6548\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6"}]}),(g,t)=>{const l=o;return u(),p(l,{frontmatter:s},{default:c(()=>[...t[0]||(t[0]=[n("div",{class:"prose m-auto"},[n("h2",{id:"\u6982\u8FF0",tabindex:"-1"},[a("\u6982\u8FF0 "),n("a",{class:"header-anchor",href:"#\u6982\u8FF0","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory\uFF08Large Language Model Factory\uFF09\u662F\u4E00\u4E2A\u4E13\u4E3A\u5927\u8BED\u8A00\u6A21\u578B\u8BAD\u7EC3\u548C\u5FAE\u8C03\u8BBE\u8BA1\u7684\u7EDF\u4E00\u6846\u67B6\uFF0C\u652F\u6301\u591A\u79CD\u6A21\u578B\u67B6\u6784\u548C\u8BAD\u7EC3\u65B9\u6CD5\u3002\u5B83\u63D0\u4F9B\u4E86\u4ECE\u6570\u636E\u9884\u5904\u7406\u5230\u6A21\u578B\u90E8\u7F72\u7684\u5B8C\u6574\u5DE5\u5177\u94FE\uFF0C\u7279\u522B\u4E13\u6CE8\u4E8E\u63D0\u5347\u8BAD\u7EC3\u6548\u7387\u548C\u964D\u4F4E\u8D44\u6E90\u6D88\u8017\u3002"),n("h2",{id:"\u4E3A\u4EC0\u4E48\u9009\u62E9-llama-factory",tabindex:"-1"},[a("\u4E3A\u4EC0\u4E48\u9009\u62E9 LLaMA Factory "),n("a",{class:"header-anchor",href:"#\u4E3A\u4EC0\u4E48\u9009\u62E9-llama-factory","aria-hidden":"true"},"#")]),n("h3",{id:"web-ui-\u754C\u9762\u5C55\u793A",tabindex:"-1"},[a("Web UI \u754C\u9762\u5C55\u793A "),n("a",{class:"header-anchor",href:"#web-ui-\u754C\u9762\u5C55\u793A","aria-hidden":"true"},"#")]),n("p",null,[n("img",{src:i,alt:"LLaMA Factory"})]),n("h3",{id:"\u6838\u5FC3\u4F18\u52BF",tabindex:"-1"},[a("\u6838\u5FC3\u4F18\u52BF "),n("a",{class:"header-anchor",href:"#\u6838\u5FC3\u4F18\u52BF","aria-hidden":"true"},"#")]),n("h4",{id:"_1-\u7EDF\u4E00\u7684\u8BAD\u7EC3\u6846\u67B6",tabindex:"-1"},[a("1. "),n("strong",null,"\u7EDF\u4E00\u7684\u8BAD\u7EC3\u6846\u67B6"),a(),n("a",{class:"header-anchor",href:"#_1-\u7EDF\u4E00\u7684\u8BAD\u7EC3\u6846\u67B6","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory \u652F\u6301\u591A\u79CD\u4E3B\u6D41\u5927\u8BED\u8A00\u6A21\u578B\uFF1A"),n("ul",null,[n("li",null,[n("strong",null,"LLaMA \u7CFB\u5217"),a("\uFF1ALLaMA, LLaMA2, Code Llama")]),n("li",null,[n("strong",null,"ChatGLM \u7CFB\u5217"),a("\uFF1AChatGLM2-6B, ChatGLM3-6B")]),n("li",null,[n("strong",null,"Qwen \u7CFB\u5217"),a("\uFF1AQwen-7B, Qwen-14B, Qwen1.5, Qwen2")]),n("li",null,[n("strong",null,"Baichuan \u7CFB\u5217"),a("\uFF1ABaichuan-7B, Baichuan2-7B, Baichuan2-13B")]),n("li",null,[n("strong",null,"\u5176\u4ED6\u6A21\u578B"),a("\uFF1AFalcon, InternLM, Yi \u7B49")])]),n("h4",{id:"_2-\u591A\u6837\u5316\u7684\u8BAD\u7EC3\u65B9\u6CD5",tabindex:"-1"},[a("2. "),n("strong",null,"\u591A\u6837\u5316\u7684\u8BAD\u7EC3\u65B9\u6CD5"),a(),n("a",{class:"header-anchor",href:"#_2-\u591A\u6837\u5316\u7684\u8BAD\u7EC3\u65B9\u6CD5","aria-hidden":"true"},"#")]),n("p",null,"\u652F\u6301\u4ECE\u5168\u53C2\u6570\u8BAD\u7EC3\u5230\u9AD8\u6548\u5FAE\u8C03\u7684\u5404\u79CD\u65B9\u6CD5\uFF1A"),n("pre",{class:"language-mermaid"},[n("code",{class:"language-mermaid"},[n("span",{class:"token keyword"},"graph"),a(` TB
    A`),n("span",{class:"token text string"},"[LLaMA Factory]"),a(),n("span",{class:"token arrow operator"},"-->"),a(" B"),n("span",{class:"token text string"},"[\u9884\u8BAD\u7EC3<br/>Pre-training]"),a(`
    A `),n("span",{class:"token arrow operator"},"-->"),a(" C"),n("span",{class:"token text string"},"[\u76D1\u7763\u5FAE\u8C03<br/>SFT]"),a(`
    A `),n("span",{class:"token arrow operator"},"-->"),a(" D"),n("span",{class:"token text string"},"[\u5956\u52B1\u5EFA\u6A21<br/>Reward Modeling]"),a(`
    A `),n("span",{class:"token arrow operator"},"-->"),a(" E"),n("span",{class:"token text string"},"[\u5F3A\u5316\u5B66\u4E60<br/>PPO/DPO]"),a(`

    B `),n("span",{class:"token arrow operator"},"-->"),a(" F"),n("span",{class:"token text string"},"[\u5168\u53C2\u6570\u8BAD\u7EC3]"),a(`
    C `),n("span",{class:"token arrow operator"},"-->"),a(" G"),n("span",{class:"token text string"},"[LoRA\u5FAE\u8C03]"),a(`
    C `),n("span",{class:"token arrow operator"},"-->"),a(" H"),n("span",{class:"token text string"},"[QLoRA\u5FAE\u8C03]"),a(`
    D `),n("span",{class:"token arrow operator"},"-->"),a(" I"),n("span",{class:"token text string"},"[\u5956\u52B1\u6A21\u578B\u8BAD\u7EC3]"),a(`
    E `),n("span",{class:"token arrow operator"},"-->"),a(" J"),n("span",{class:"token text string"},"[RLHF\u8BAD\u7EC3]"),a(`

    `),n("span",{class:"token keyword"},"style"),a(" A "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#e8f5e8")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" G "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#fff3e0")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" H "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#e3f2fd")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" J "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#f3e5f5")]),a(`
`)])]),n("h4",{id:"_3-\u9AD8\u6548\u7684\u53C2\u6570\u4F18\u5316",tabindex:"-1"},[a("3. "),n("strong",null,"\u9AD8\u6548\u7684\u53C2\u6570\u4F18\u5316"),a(),n("a",{class:"header-anchor",href:"#_3-\u9AD8\u6548\u7684\u53C2\u6570\u4F18\u5316","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"LoRA\uFF08Low-Rank Adaptation\uFF09"),a("\uFF1A\u51CF\u5C11\u53EF\u8BAD\u7EC3\u53C2\u6570\u81F3\u539F\u6A21\u578B\u7684 0.1%-1%")]),n("li",null,[n("strong",null,"QLoRA\uFF08Quantized LoRA\uFF09"),a("\uFF1A\u7ED3\u5408 4-bit \u91CF\u5316\uFF0C\u8FDB\u4E00\u6B65\u964D\u4F4E\u663E\u5B58\u9700\u6C42")]),n("li",null,[n("strong",null,"\u6DF7\u5408\u7CBE\u5EA6\u8BAD\u7EC3"),a("\uFF1A\u652F\u6301 FP16/BF16\uFF0C\u63D0\u5347\u8BAD\u7EC3\u901F\u5EA6")])]),n("h4",{id:"_4-\u7528\u6237\u53CB\u597D\u7684\u754C\u9762",tabindex:"-1"},[a("4. "),n("strong",null,"\u7528\u6237\u53CB\u597D\u7684\u754C\u9762"),a(),n("a",{class:"header-anchor",href:"#_4-\u7528\u6237\u53CB\u597D\u7684\u754C\u9762","aria-hidden":"true"},"#")]),n("p",null,"\u63D0\u4F9B Web UI \u548C\u547D\u4EE4\u884C\u4E24\u79CD\u4F7F\u7528\u65B9\u5F0F\uFF0C\u964D\u4F4E\u6280\u672F\u95E8\u69DB\u3002"),n("h2",{id:"\u6280\u672F\u67B6\u6784",tabindex:"-1"},[a("\u6280\u672F\u67B6\u6784 "),n("a",{class:"header-anchor",href:"#\u6280\u672F\u67B6\u6784","aria-hidden":"true"},"#")]),n("h3",{id:"\u7CFB\u7EDF\u67B6\u6784\u56FE",tabindex:"-1"},[a("\u7CFB\u7EDF\u67B6\u6784\u56FE "),n("a",{class:"header-anchor",href:"#\u7CFB\u7EDF\u67B6\u6784\u56FE","aria-hidden":"true"},"#")]),n("p",null,[n("img",{src:k,alt:"\u7CFB\u7EDF\u67B6\u6784\u56FE"})]),n("h3",{id:"\u67B6\u6784\u5C42\u6B21\u89E3\u6790",tabindex:"-1"},[a("\u67B6\u6784\u5C42\u6B21\u89E3\u6790 "),n("a",{class:"header-anchor",href:"#\u67B6\u6784\u5C42\u6B21\u89E3\u6790","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory \u91C7\u7528\u5206\u5C42\u67B6\u6784\u8BBE\u8BA1\uFF0C\u4ECE\u4E0A\u5230\u4E0B\u5206\u4E3A\u56DB\u4E2A\u4E3B\u8981\u5C42\u6B21\uFF1A"),n("h4",{id:"_1-\u7528\u6237\u63A5\u53E3\u5C42",tabindex:"-1"},[a("1. \u7528\u6237\u63A5\u53E3\u5C42 "),n("a",{class:"header-anchor",href:"#_1-\u7528\u6237\u63A5\u53E3\u5C42","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"Web UI \u754C\u9762"),a("\uFF1A\u63D0\u4F9B\u53EF\u89C6\u5316\u7684\u8BAD\u7EC3\u914D\u7F6E\u548C\u76D1\u63A7\u754C\u9762")]),n("li",null,[n("strong",null,"\u547D\u4EE4\u884C\u5DE5\u5177"),a("\uFF1A\u652F\u6301\u811A\u672C\u5316\u7684\u6279\u91CF\u64CD\u4F5C\u548C\u81EA\u52A8\u5316\u6D41\u7A0B")]),n("li",null,[n("strong",null,"\u914D\u7F6E\u6587\u4EF6"),a("\uFF1A\u901A\u8FC7 YAML \u6587\u4EF6\u7075\u6D3B\u914D\u7F6E\u8BAD\u7EC3\u53C2\u6570")])]),n("h4",{id:"_2-\u8BAD\u7EC3\u5F15\u64CE\u5C42",tabindex:"-1"},[a("2. \u8BAD\u7EC3\u5F15\u64CE\u5C42 "),n("a",{class:"header-anchor",href:"#_2-\u8BAD\u7EC3\u5F15\u64CE\u5C42","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"\u6570\u636E\u5904\u7406\u6A21\u5757"),a("\uFF1A\u8D1F\u8D23\u6570\u636E\u9884\u5904\u7406\u3001\u683C\u5F0F\u8F6C\u6362\u548C\u589E\u5F3A")]),n("li",null,[n("strong",null,"\u6A21\u578B\u7BA1\u7406\u6A21\u5757"),a("\uFF1A\u5904\u7406\u6A21\u578B\u52A0\u8F7D\u3001\u4FDD\u5B58\u548C\u7248\u672C\u7BA1\u7406")]),n("li",null,[n("strong",null,"\u8BAD\u7EC3\u8C03\u5EA6\u6A21\u5757"),a("\uFF1A\u63A7\u5236\u8BAD\u7EC3\u6D41\u7A0B\u548C\u8D44\u6E90\u5206\u914D")]),n("li",null,[n("strong",null,"\u8BC4\u4F30\u6A21\u5757"),a("\uFF1A\u63D0\u4F9B\u6A21\u578B\u6027\u80FD\u8BC4\u4F30\u548C\u6307\u6807\u8BA1\u7B97")])]),n("h4",{id:"_3-\u4F18\u5316\u6280\u672F\u5C42",tabindex:"-1"},[a("3. \u4F18\u5316\u6280\u672F\u5C42 "),n("a",{class:"header-anchor",href:"#_3-\u4F18\u5316\u6280\u672F\u5C42","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"LoRA/QLoRA"),a("\uFF1A\u53C2\u6570\u9AD8\u6548\u5FAE\u8C03\u6280\u672F")]),n("li",null,[n("strong",null,"\u6DF7\u5408\u7CBE\u5EA6\u8BAD\u7EC3"),a("\uFF1AFP16/BF16 \u7CBE\u5EA6\u4F18\u5316")]),n("li",null,[n("strong",null,"\u68AF\u5EA6\u68C0\u67E5\u70B9"),a("\uFF1A\u5185\u5B58\u4F18\u5316\u6280\u672F")]),n("li",null,[n("strong",null,"DeepSpeed \u96C6\u6210"),a("\uFF1A\u5206\u5E03\u5F0F\u8BAD\u7EC3\u52A0\u901F")])]),n("h4",{id:"_4-\u6A21\u578B\u652F\u6301\u5C42",tabindex:"-1"},[a("4. \u6A21\u578B\u652F\u6301\u5C42 "),n("a",{class:"header-anchor",href:"#_4-\u6A21\u578B\u652F\u6301\u5C42","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"Transformers \u96C6\u6210"),a("\uFF1A\u57FA\u4E8E HuggingFace \u751F\u6001")]),n("li",null,[n("strong",null,"PEFT \u5E93"),a("\uFF1A\u53C2\u6570\u9AD8\u6548\u5FAE\u8C03\u7B97\u6CD5\u5E93")]),n("li",null,[n("strong",null,"FSDP \u652F\u6301"),a("\uFF1A\u5168\u5207\u7247\u6570\u636E\u5E76\u884C")]),n("li",null,[n("strong",null,"\u6A21\u578B\u5E76\u884C"),a("\uFF1A\u5927\u6A21\u578B\u5206\u5E03\u5F0F\u63A8\u7406")])]),n("h3",{id:"\u6838\u5FC3\u7279\u6027",tabindex:"-1"},[a("\u6838\u5FC3\u7279\u6027 "),n("a",{class:"header-anchor",href:"#\u6838\u5FC3\u7279\u6027","aria-hidden":"true"},"#")]),n("h4",{id:"_1-\u7075\u6D3B\u7684\u6570\u636E\u5904\u7406",tabindex:"-1"},[a("1. "),n("strong",null,"\u7075\u6D3B\u7684\u6570\u636E\u5904\u7406"),a(),n("a",{class:"header-anchor",href:"#_1-\u7075\u6D3B\u7684\u6570\u636E\u5904\u7406","aria-hidden":"true"},"#")]),n("p",null,"\u652F\u6301\u591A\u79CD\u6570\u636E\u683C\u5F0F\u548C\u9884\u5904\u7406\u65B9\u5F0F\uFF1A"),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u6570\u636E\u683C\u5F0F\u793A\u4F8B"),a(`
`),n("span",{class:"token punctuation"},"{"),a(`
    `),n("span",{class:"token string"},'"instruction"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u8BF7\u89E3\u91CA\u4EC0\u4E48\u662F\u673A\u5668\u5B66\u4E60"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"input"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"output"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u673A\u5668\u5B66\u4E60\u662F\u4EBA\u5DE5\u667A\u80FD\u7684\u4E00\u4E2A\u5206\u652F..."'),a(`
`),n("span",{class:"token punctuation"},"}"),a(`

`),n("span",{class:"token comment"},"# \u652F\u6301\u7684\u6570\u636E\u683C\u5F0F"),a(`
formats `),n("span",{class:"token operator"},"="),a(),n("span",{class:"token punctuation"},"{"),a(`
    `),n("span",{class:"token string"},'"alpaca"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u6307\u4EE4\u5FAE\u8C03\u683C\u5F0F"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"sharegpt"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u5BF9\u8BDD\u683C\u5F0F"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"openai"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"OpenAI API\u683C\u5F0F"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"custom"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u81EA\u5B9A\u4E49\u683C\u5F0F"'),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`)])]),n("h4",{id:"_2-\u9AD8\u6548\u7684\u5185\u5B58\u7BA1\u7406",tabindex:"-1"},[a("2. "),n("strong",null,"\u9AD8\u6548\u7684\u5185\u5B58\u7BA1\u7406"),a(),n("a",{class:"header-anchor",href:"#_2-\u9AD8\u6548\u7684\u5185\u5B58\u7BA1\u7406","aria-hidden":"true"},"#")]),n("p",null,"\u901A\u8FC7\u591A\u79CD\u6280\u672F\u4F18\u5316\u663E\u5B58\u4F7F\u7528\uFF1A"),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"\u6280\u672F"),n("th",null,"\u663E\u5B58\u4F18\u5316\u6548\u679C"),n("th",null,"\u8BAD\u7EC3\u901F\u5EA6\u5F71\u54CD"),n("th",null,"\u9002\u7528\u573A\u666F")])]),n("tbody",null,[n("tr",null,[n("td",null,"LoRA"),n("td",null,"\u51CF\u5C11 90%+"),n("td",null,"\u51E0\u4E4E\u65E0\u5F71\u54CD"),n("td",null,"\u6307\u4EE4\u5FAE\u8C03")]),n("tr",null,[n("td",null,"QLoRA"),n("td",null,"\u51CF\u5C11 95%+"),n("td",null,"\u8F7B\u5FAE\u964D\u4F4E"),n("td",null,"\u8D44\u6E90\u53D7\u9650\u73AF\u5883")]),n("tr",null,[n("td",null,"\u68AF\u5EA6\u68C0\u67E5\u70B9"),n("td",null,"\u51CF\u5C11 50%"),n("td",null,"\u8F7B\u5FAE\u964D\u4F4E"),n("td",null,"\u5927\u6A21\u578B\u8BAD\u7EC3")]),n("tr",null,[n("td",null,"DeepSpeed ZeRO"),n("td",null,"\u51CF\u5C11 75%"),n("td",null,"\u51E0\u4E4E\u65E0\u5F71\u54CD"),n("td",null,"\u591A GPU \u8BAD\u7EC3")]),n("tr",null,[n("td",null,"\u6DF7\u5408\u7CBE\u5EA6\u8BAD\u7EC3"),n("td",null,"\u51CF\u5C11 50%"),n("td",null,"\u63D0\u5347 1.5x"),n("td",null,"\u73B0\u4EE3 GPU \u786C\u4EF6")])])]),n("h2",{id:"\u5B9E\u9645\u4F7F\u7528\u6848\u4F8B",tabindex:"-1"},[a("\u5B9E\u9645\u4F7F\u7528\u6848\u4F8B "),n("a",{class:"header-anchor",href:"#\u5B9E\u9645\u4F7F\u7528\u6848\u4F8B","aria-hidden":"true"},"#")]),n("h3",{id:"_1-\u5FEB\u901F\u5F00\u59CB\uFF1Alora-\u5FAE\u8C03",tabindex:"-1"},[a("1. \u5FEB\u901F\u5F00\u59CB\uFF1ALoRA \u5FAE\u8C03 "),n("a",{class:"header-anchor",href:"#_1-\u5FEB\u901F\u5F00\u59CB\uFF1Alora-\u5FAE\u8C03","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token comment"},"# \u5B89\u88C5 LLaMA Factory"),a(`
`),n("span",{class:"token function"},"git"),a(` clone https://github.com/hiyouga/LLaMA-Factory.git
`),n("span",{class:"token builtin class-name"},"cd"),a(` LLaMA-Factory
pip `),n("span",{class:"token function"},"install"),a(),n("span",{class:"token parameter variable"},"-r"),a(` requirements.txt

`),n("span",{class:"token comment"},"# \u542F\u52A8 Web UI"),a(`
python src/webui.py
`)])]),n("h3",{id:"_2-\u547D\u4EE4\u884C\u8BAD\u7EC3\u793A\u4F8B",tabindex:"-1"},[a("2. \u547D\u4EE4\u884C\u8BAD\u7EC3\u793A\u4F8B "),n("a",{class:"header-anchor",href:"#_2-\u547D\u4EE4\u884C\u8BAD\u7EC3\u793A\u4F8B","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token comment"},"# LoRA \u5FAE\u8C03 Qwen-7B"),a(`
python src/train.py `),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--stage"),a(" sft "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--model_name_or_path"),a(" qwen/Qwen-7B-Chat "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--do_train"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--dataset"),a(" alpaca_gpt4_zh "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--template"),a(" qwen "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--finetuning_type"),a(" lora "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--lora_target"),a(" q_proj,v_proj "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--output_dir"),a(" ./saves/qwen-7b-lora "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--overwrite_cache"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--per_device_train_batch_size"),a(),n("span",{class:"token number"},"4"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--gradient_accumulation_steps"),a(),n("span",{class:"token number"},"4"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--lr_scheduler_type"),a(" cosine "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--logging_steps"),a(),n("span",{class:"token number"},"10"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--save_steps"),a(),n("span",{class:"token number"},"1000"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--learning_rate"),a(" 5e-5 "),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--num_train_epochs"),a(),n("span",{class:"token number"},"3.0"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--max_samples"),a(),n("span",{class:"token number"},"3000"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--max_grad_norm"),a(),n("span",{class:"token number"},"1.0"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--quantization_bit"),a(),n("span",{class:"token number"},"4"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--loraplus_lr_ratio"),a(),n("span",{class:"token number"},"16.0"),a(),n("span",{class:"token punctuation"},"\\"),a(`
    `),n("span",{class:"token parameter variable"},"--fp16"),a(`
`)])]),n("h3",{id:"_3-\u914D\u7F6E\u6587\u4EF6\u65B9\u5F0F",tabindex:"-1"},[a("3. \u914D\u7F6E\u6587\u4EF6\u65B9\u5F0F "),n("a",{class:"header-anchor",href:"#_3-\u914D\u7F6E\u6587\u4EF6\u65B9\u5F0F","aria-hidden":"true"},"#")]),n("pre",{class:"language-yaml"},[n("code",{class:"language-yaml"},[n("span",{class:"token comment"},"# config/qwen_lora_sft.yaml"),a(`
`),n("span",{class:"token key atrule"},"model_name_or_path"),n("span",{class:"token punctuation"},":"),a(" qwen/Qwen"),n("span",{class:"token punctuation"},"-"),a("7B"),n("span",{class:"token punctuation"},"-"),a(`Chat
`),n("span",{class:"token key atrule"},"stage"),n("span",{class:"token punctuation"},":"),a(` sft
`),n("span",{class:"token key atrule"},"do_train"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean important"},"true"),a(`
`),n("span",{class:"token key atrule"},"finetuning_type"),n("span",{class:"token punctuation"},":"),a(` lora
`),n("span",{class:"token key atrule"},"lora_target"),n("span",{class:"token punctuation"},":"),a(" q_proj"),n("span",{class:"token punctuation"},","),a(`v_proj
`),n("span",{class:"token key atrule"},"dataset"),n("span",{class:"token punctuation"},":"),a(` alpaca_gpt4_zh
`),n("span",{class:"token key atrule"},"template"),n("span",{class:"token punctuation"},":"),a(` qwen
`),n("span",{class:"token key atrule"},"cutoff_len"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1024"),a(`
`),n("span",{class:"token key atrule"},"max_samples"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1000"),a(`
`),n("span",{class:"token key atrule"},"overwrite_cache"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean important"},"true"),a(`
`),n("span",{class:"token key atrule"},"output_dir"),n("span",{class:"token punctuation"},":"),a(" saves/qwen"),n("span",{class:"token punctuation"},"-"),a("7b"),n("span",{class:"token punctuation"},"-"),a(`lora
`),n("span",{class:"token key atrule"},"logging_steps"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"10"),a(`
`),n("span",{class:"token key atrule"},"save_steps"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"500"),a(`
`),n("span",{class:"token key atrule"},"plot_loss"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean important"},"true"),a(`
`),n("span",{class:"token key atrule"},"overwrite_output_dir"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean important"},"true"),a(`
`),n("span",{class:"token key atrule"},"per_device_train_batch_size"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"2"),a(`
`),n("span",{class:"token key atrule"},"gradient_accumulation_steps"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"4"),a(`
`),n("span",{class:"token key atrule"},"learning_rate"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1.0e-4"),a(`
`),n("span",{class:"token key atrule"},"num_train_epochs"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"3.0"),a(`
`),n("span",{class:"token key atrule"},"lr_scheduler_type"),n("span",{class:"token punctuation"},":"),a(` cosine
`),n("span",{class:"token key atrule"},"warmup_steps"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"0"),a(`
`),n("span",{class:"token key atrule"},"fp16"),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean important"},"true"),a(`
`)])]),n("h2",{id:"\u9AD8\u7EA7\u529F\u80FD",tabindex:"-1"},[a("\u9AD8\u7EA7\u529F\u80FD "),n("a",{class:"header-anchor",href:"#\u9AD8\u7EA7\u529F\u80FD","aria-hidden":"true"},"#")]),n("h3",{id:"_1-\u5F3A\u5316\u5B66\u4E60\u4EBA\u7C7B\u53CD\u9988\uFF08rlhf\uFF09",tabindex:"-1"},[a("1. \u5F3A\u5316\u5B66\u4E60\u4EBA\u7C7B\u53CD\u9988\uFF08RLHF\uFF09 "),n("a",{class:"header-anchor",href:"#_1-\u5F3A\u5316\u5B66\u4E60\u4EBA\u7C7B\u53CD\u9988\uFF08rlhf\uFF09","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory \u652F\u6301\u5B8C\u6574\u7684 RLHF \u6D41\u7A0B\uFF1A"),n("pre",{class:"language-mermaid"},[n("code",{class:"language-mermaid"},[n("span",{class:"token keyword"},"graph"),a(` LR
    A`),n("span",{class:"token text string"},"[\u57FA\u7840\u6A21\u578B]"),a(),n("span",{class:"token arrow operator"},"-->"),a(" B"),n("span",{class:"token text string"},"[\u76D1\u7763\u5FAE\u8C03<br/>SFT]"),a(`
    B `),n("span",{class:"token arrow operator"},"-->"),a(" C"),n("span",{class:"token text string"},"[\u5956\u52B1\u6A21\u578B<br/>RM\u8BAD\u7EC3]"),a(`
    C `),n("span",{class:"token arrow operator"},"-->"),a(" D"),n("span",{class:"token text string"},"[PPO\u8BAD\u7EC3<br/>\u5F3A\u5316\u5B66\u4E60]"),a(`
    D `),n("span",{class:"token arrow operator"},"-->"),a(" E"),n("span",{class:"token text string"},"[\u5BF9\u9F50\u6A21\u578B]"),a(`

    F`),n("span",{class:"token text string"},"[\u4EBA\u7C7B\u504F\u597D\u6570\u636E]"),a(),n("span",{class:"token arrow operator"},"-->"),a(` C
    G`),n("span",{class:"token text string"},"[\u6307\u4EE4\u6570\u636E]"),a(),n("span",{class:"token arrow operator"},"-->"),a(` B

    `),n("span",{class:"token keyword"},"style"),a(" B "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#e8f5e8")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" C "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#fff3e0")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" D "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#e3f2fd")]),a(`
    `),n("span",{class:"token keyword"},"style"),a(" E "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),a("#f3e5f5")]),a(`
`)])]),n("h3",{id:"_2-\u591A-gpu-\u5206\u5E03\u5F0F\u8BAD\u7EC3",tabindex:"-1"},[a("2. \u591A GPU \u5206\u5E03\u5F0F\u8BAD\u7EC3 "),n("a",{class:"header-anchor",href:"#_2-\u591A-gpu-\u5206\u5E03\u5F0F\u8BAD\u7EC3","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# DeepSpeed \u914D\u7F6E\u793A\u4F8B"),a(`
`),n("span",{class:"token punctuation"},"{"),a(`
    `),n("span",{class:"token string"},'"train_batch_size"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"64"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"train_micro_batch_size_per_gpu"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"steps_per_print"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"zero_optimization"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token punctuation"},"{"),a(`
        `),n("span",{class:"token string"},'"stage"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"allgather_partitions"'),n("span",{class:"token punctuation"},":"),a(" true"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"reduce_scatter"'),n("span",{class:"token punctuation"},":"),a(" true"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"allgather_bucket_size"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"500000000"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"reduce_bucket_size"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"500000000"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"overlap_comm"'),n("span",{class:"token punctuation"},":"),a(" false"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"contiguous_gradients"'),n("span",{class:"token punctuation"},":"),a(" true"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"cpu_offload"'),n("span",{class:"token punctuation"},":"),a(` false
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"fp16"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token punctuation"},"{"),a(`
        `),n("span",{class:"token string"},'"enabled"'),n("span",{class:"token punctuation"},":"),a(" true"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"loss_scale"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"loss_scale_window"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1000"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"hysteresis"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),a(`
        `),n("span",{class:"token string"},'"min_loss_scale"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1"),a(`
    `),n("span",{class:"token punctuation"},"}"),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`)])]),n("h3",{id:"_3-\u6A21\u578B\u8BC4\u4F30\u4E0E\u5BFC\u51FA",tabindex:"-1"},[a("3. \u6A21\u578B\u8BC4\u4F30\u4E0E\u5BFC\u51FA "),n("a",{class:"header-anchor",href:"#_3-\u6A21\u578B\u8BC4\u4F30\u4E0E\u5BFC\u51FA","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u6A21\u578B\u8BC4\u4F30"),a(`
python src`),n("span",{class:"token operator"},"/"),a("evaluate"),n("span",{class:"token punctuation"},"."),a(`py \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("model_name_or_path "),n("span",{class:"token punctuation"},"."),n("span",{class:"token operator"},"/"),a("saves"),n("span",{class:"token operator"},"/"),a("qwen"),n("span",{class:"token operator"},"-"),a("7b"),n("span",{class:"token operator"},"-"),a(`lora \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("adapter_name_or_path "),n("span",{class:"token punctuation"},"."),n("span",{class:"token operator"},"/"),a("saves"),n("span",{class:"token operator"},"/"),a("qwen"),n("span",{class:"token operator"},"-"),a("7b"),n("span",{class:"token operator"},"-"),a(`lora \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`template qwen \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`task ceval \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`split validation \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`lang zh \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("n_shot "),n("span",{class:"token number"},"5"),a(` \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("batch_size "),n("span",{class:"token number"},"4"),a(`

`),n("span",{class:"token comment"},"# \u6A21\u578B\u5408\u5E76\u4E0E\u5BFC\u51FA"),a(`
python src`),n("span",{class:"token operator"},"/"),a("export_model"),n("span",{class:"token punctuation"},"."),a(`py \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("model_name_or_path qwen"),n("span",{class:"token operator"},"/"),a("Qwen"),n("span",{class:"token operator"},"-"),a("7B"),n("span",{class:"token operator"},"-"),a(`Chat \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("adapter_name_or_path "),n("span",{class:"token punctuation"},"."),n("span",{class:"token operator"},"/"),a("saves"),n("span",{class:"token operator"},"/"),a("qwen"),n("span",{class:"token operator"},"-"),a("7b"),n("span",{class:"token operator"},"-"),a(`lora \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`template qwen \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`finetuning_type lora \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("export_dir "),n("span",{class:"token punctuation"},"."),n("span",{class:"token operator"},"/"),a("saves"),n("span",{class:"token operator"},"/"),a("qwen"),n("span",{class:"token operator"},"-"),a("7b"),n("span",{class:"token operator"},"-"),a(`merged \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a("export_size "),n("span",{class:"token number"},"2"),a(` \\
    `),n("span",{class:"token operator"},"-"),n("span",{class:"token operator"},"-"),a(`export_legacy_format false
`)])]),n("h2",{id:"\u6027\u80FD\u4F18\u5316",tabindex:"-1"},[a("\u6027\u80FD\u4F18\u5316 "),n("a",{class:"header-anchor",href:"#\u6027\u80FD\u4F18\u5316","aria-hidden":"true"},"#")]),n("h3",{id:"\u663E\u5B58\u4F18\u5316\u7B56\u7565",tabindex:"-1"},[a("\u663E\u5B58\u4F18\u5316\u7B56\u7565 "),n("a",{class:"header-anchor",href:"#\u663E\u5B58\u4F18\u5316\u7B56\u7565","aria-hidden":"true"},"#")]),n("p",null,"\u6839\u636E\u4E0D\u540C\u786C\u4EF6\u914D\u7F6E\u7684\u4F18\u5316\u5EFA\u8BAE\uFF1A"),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"GPU \u663E\u5B58"),n("th",null,"\u63A8\u8350\u914D\u7F6E"),n("th",null,"\u6A21\u578B\u89C4\u6A21"),n("th",null,"\u8BAD\u7EC3\u65B9\u6CD5")])]),n("tbody",null,[n("tr",null,[n("td",null,"4-8GB"),n("td",null,"QLoRA + 4bit \u91CF\u5316"),n("td",null,"7B \u6A21\u578B"),n("td",null,"LoRA \u5FAE\u8C03")]),n("tr",null,[n("td",null,"12-16GB"),n("td",null,"LoRA + \u6DF7\u5408\u7CBE\u5EA6"),n("td",null,"7B-13B \u6A21\u578B"),n("td",null,"LoRA \u5FAE\u8C03")]),n("tr",null,[n("td",null,"24GB+"),n("td",null,"\u5168\u53C2\u6570\u5FAE\u8C03 + DeepSpeed"),n("td",null,"7B \u6A21\u578B"),n("td",null,"\u5168\u53C2\u6570")]),n("tr",null,[n("td",null,"80GB+"),n("td",null,"\u5168\u53C2\u6570\u5FAE\u8C03 + \u6A21\u578B\u5E76\u884C"),n("td",null,"13B-70B \u6A21\u578B"),n("td",null,"\u5168\u53C2\u6570")])])]),n("h3",{id:"\u8BAD\u7EC3\u6548\u7387\u4F18\u5316",tabindex:"-1"},[a("\u8BAD\u7EC3\u6548\u7387\u4F18\u5316 "),n("a",{class:"header-anchor",href:"#\u8BAD\u7EC3\u6548\u7387\u4F18\u5316","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u63A8\u8350\u7684\u8BAD\u7EC3\u914D\u7F6E"),a(`
training_config `),n("span",{class:"token operator"},"="),a(),n("span",{class:"token punctuation"},"{"),a(`
    `),n("span",{class:"token string"},'"per_device_train_batch_size"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"gradient_accumulation_steps"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"max_grad_norm"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"1.0"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"learning_rate"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"5e-5"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"warmup_ratio"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"0.1"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"lr_scheduler_type"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"cosine"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"save_strategy"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"steps"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"save_steps"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"500"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"evaluation_strategy"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"steps"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"eval_steps"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"500"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"logging_steps"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"fp16"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean"},"True"),n("span",{class:"token punctuation"},","),a("  "),n("span",{class:"token comment"},"# \u6216 bf16"),a(`
    `),n("span",{class:"token string"},'"dataloader_num_workers"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"remove_unused_columns"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean"},"False"),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"ddp_find_unused_parameters"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token boolean"},"False"),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`)])]),n("h2",{id:"\u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848",tabindex:"-1"},[a("\u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848 "),n("a",{class:"header-anchor",href:"#\u5E38\u89C1\u95EE\u9898\u4E0E\u89E3\u51B3\u65B9\u6848","aria-hidden":"true"},"#")]),n("h3",{id:"_1-\u663E\u5B58\u4E0D\u8DB3",tabindex:"-1"},[a("1. \u663E\u5B58\u4E0D\u8DB3 "),n("a",{class:"header-anchor",href:"#_1-\u663E\u5B58\u4E0D\u8DB3","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),a("\uFF1A\u8BAD\u7EC3\u65F6\u51FA\u73B0 CUDA out of memory")]),n("p",null,[n("strong",null,"\u89E3\u51B3\u65B9\u6848"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u964D\u4F4E batch size \u6216\u589E\u52A0\u68AF\u5EA6\u7D2F\u79EF\u6B65\u6570"),n("li",null,"\u4F7F\u7528\u91CF\u5316\u8BAD\u7EC3\uFF084-bit \u6216 8-bit\uFF09"),n("li",null,"\u542F\u7528\u68AF\u5EA6\u68C0\u67E5\u70B9"),n("li",null,"\u4F7F\u7528 DeepSpeed ZeRO")]),n("h3",{id:"_2-\u8BAD\u7EC3\u4E0D\u6536\u655B",tabindex:"-1"},[a("2. \u8BAD\u7EC3\u4E0D\u6536\u655B "),n("a",{class:"header-anchor",href:"#_2-\u8BAD\u7EC3\u4E0D\u6536\u655B","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),a("\uFF1A\u635F\u5931\u4E0D\u4E0B\u964D\u6216\u6A21\u578B\u6027\u80FD\u5DEE")]),n("p",null,[n("strong",null,"\u89E3\u51B3\u65B9\u6848"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u68C0\u67E5\u6570\u636E\u8D28\u91CF\u548C\u683C\u5F0F"),n("li",null,"\u8C03\u6574\u5B66\u4E60\u7387\uFF08\u901A\u5E38 LoRA \u9700\u8981\u66F4\u9AD8\u7684\u5B66\u4E60\u7387\uFF09"),n("li",null,"\u589E\u52A0\u8BAD\u7EC3\u6570\u636E\u91CF"),n("li",null,"\u8C03\u6574 LoRA \u53C2\u6570\uFF08rank, alpha\uFF09")]),n("h3",{id:"_3-\u63A8\u7406\u901F\u5EA6\u6162",tabindex:"-1"},[a("3. \u63A8\u7406\u901F\u5EA6\u6162 "),n("a",{class:"header-anchor",href:"#_3-\u63A8\u7406\u901F\u5EA6\u6162","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),a("\uFF1A\u5FAE\u8C03\u540E\u6A21\u578B\u63A8\u7406\u901F\u5EA6\u6162")]),n("p",null,[n("strong",null,"\u89E3\u51B3\u65B9\u6848"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u5408\u5E76 LoRA \u6743\u91CD\u5230\u57FA\u7840\u6A21\u578B"),n("li",null,"\u4F7F\u7528 vLLM \u7B49\u63A8\u7406\u52A0\u901F\u6846\u67B6"),n("li",null,"\u91CF\u5316\u6A21\u578B\u5230 INT8 \u6216 INT4")]),n("h2",{id:"\u5DE5\u5177\u751F\u6001\u4E0E\u96C6\u6210",tabindex:"-1"},[a("\u5DE5\u5177\u751F\u6001\u4E0E\u96C6\u6210 "),n("a",{class:"header-anchor",href:"#\u5DE5\u5177\u751F\u6001\u4E0E\u96C6\u6210","aria-hidden":"true"},"#")]),n("h3",{id:"\u4E3B\u8981\u7EC4\u4EF6",tabindex:"-1"},[a("\u4E3B\u8981\u7EC4\u4EF6 "),n("a",{class:"header-anchor",href:"#\u4E3B\u8981\u7EC4\u4EF6","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"Transformers"),a("\uFF1A\u57FA\u7840\u6A21\u578B\u5E93")]),n("li",null,[n("strong",null,"PEFT"),a("\uFF1A\u53C2\u6570\u9AD8\u6548\u5FAE\u8C03\u5E93")]),n("li",null,[n("strong",null,"DeepSpeed"),a("\uFF1A\u5206\u5E03\u5F0F\u8BAD\u7EC3\u4F18\u5316")]),n("li",null,[n("strong",null,"BitsAndBytes"),a("\uFF1A\u91CF\u5316\u8BAD\u7EC3\u652F\u6301")]),n("li",null,[n("strong",null,"vLLM"),a("\uFF1A\u9AD8\u901F\u63A8\u7406\u5F15\u64CE")])]),n("h3",{id:"\u6570\u636E\u96C6\u652F\u6301",tabindex:"-1"},[a("\u6570\u636E\u96C6\u652F\u6301 "),n("a",{class:"header-anchor",href:"#\u6570\u636E\u96C6\u652F\u6301","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory \u5185\u7F6E\u4E86\u591A\u4E2A\u9AD8\u8D28\u91CF\u6570\u636E\u96C6\uFF1A"),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u5185\u7F6E\u6570\u636E\u96C6\u5217\u8868"),a(`
datasets `),n("span",{class:"token operator"},"="),a(),n("span",{class:"token punctuation"},"{"),a(`
    `),n("span",{class:"token string"},'"alpaca_gpt4_zh"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u6307\u4EE4\u6570\u636E\u96C6"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"belle_2m_cn"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u5BF9\u8BDD\u6570\u636E\u96C6"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"firefly_train_1.1m"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u6307\u4EE4\u5FAE\u8C03\u6570\u636E\u96C6"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"moss_003_sft_data"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u52A9\u624B\u6570\u636E\u96C6"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"c_eval"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u8BC4\u4F30\u57FA\u51C6"'),n("span",{class:"token punctuation"},","),a(`
    `),n("span",{class:"token string"},'"cmmlu"'),n("span",{class:"token punctuation"},":"),a(),n("span",{class:"token string"},'"\u4E2D\u6587\u8BED\u8A00\u7406\u89E3\u8BC4\u4F30"'),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`)])]),n("h2",{id:"\u672A\u6765\u53D1\u5C55\u65B9\u5411",tabindex:"-1"},[a("\u672A\u6765\u53D1\u5C55\u65B9\u5411 "),n("a",{class:"header-anchor",href:"#\u672A\u6765\u53D1\u5C55\u65B9\u5411","aria-hidden":"true"},"#")]),n("h3",{id:"\u6280\u672F\u8D8B\u52BF",tabindex:"-1"},[a("\u6280\u672F\u8D8B\u52BF "),n("a",{class:"header-anchor",href:"#\u6280\u672F\u8D8B\u52BF","aria-hidden":"true"},"#")]),n("ol",null,[n("li",null,[n("strong",null,"\u66F4\u9AD8\u6548\u7684\u5FAE\u8C03\u65B9\u6CD5"),a("\uFF1A\u63A2\u7D22\u65B0\u7684\u53C2\u6570\u9AD8\u6548\u5FAE\u8C03\u6280\u672F")]),n("li",null,[n("strong",null,"\u591A\u6A21\u6001\u652F\u6301"),a("\uFF1A\u96C6\u6210\u89C6\u89C9\u3001\u97F3\u9891\u7B49\u591A\u6A21\u6001\u80FD\u529B")]),n("li",null,[n("strong",null,"\u81EA\u52A8\u5316\u8C03\u4F18"),a("\uFF1A\u667A\u80FD\u8D85\u53C2\u6570\u641C\u7D22\u548C\u6A21\u578B\u67B6\u6784\u4F18\u5316")]),n("li",null,[n("strong",null,"\u8FB9\u7F18\u90E8\u7F72"),a("\uFF1A\u652F\u6301\u79FB\u52A8\u8BBE\u5907\u548C\u8FB9\u7F18\u8BA1\u7B97\u73AF\u5883")])]),n("h3",{id:"\u751F\u6001\u5EFA\u8BBE",tabindex:"-1"},[a("\u751F\u6001\u5EFA\u8BBE "),n("a",{class:"header-anchor",href:"#\u751F\u6001\u5EFA\u8BBE","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"\u6A21\u578B\u5E02\u573A"),a("\uFF1A\u9884\u8BAD\u7EC3\u6A21\u578B\u548C\u5FAE\u8C03\u6A21\u578B\u7684\u5206\u4EAB\u5E73\u53F0")]),n("li",null,[n("strong",null,"\u8BC4\u4F30\u6846\u67B6"),a("\uFF1A\u6807\u51C6\u5316\u7684\u6A21\u578B\u8BC4\u4F30\u548C\u6BD4\u8F83\u5DE5\u5177")]),n("li",null,[n("strong",null,"\u90E8\u7F72\u5DE5\u5177"),a("\uFF1A\u4E00\u952E\u90E8\u7F72\u5230\u4E91\u670D\u52A1\u548C\u8FB9\u7F18\u8BBE\u5907")])]),n("h2",{id:"\u76F8\u5173\u8D44\u6E90",tabindex:"-1"},[a("\u76F8\u5173\u8D44\u6E90 "),n("a",{class:"header-anchor",href:"#\u76F8\u5173\u8D44\u6E90","aria-hidden":"true"},"#")]),n("h3",{id:"\u5B98\u65B9\u8D44\u6E90",tabindex:"-1"},[a("\u5B98\u65B9\u8D44\u6E90 "),n("a",{class:"header-anchor",href:"#\u5B98\u65B9\u8D44\u6E90","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"GitHub \u4ED3\u5E93"),a("\uFF1A"),n("a",{href:"https://github.com/hiyouga/LLaMA-Factory",target:"_blank",rel:"noopener"},"LLaMA Factory")]),n("li",null,[n("strong",null,"\u6280\u672F\u6587\u6863"),a("\uFF1A"),n("a",{href:"https://github.com/hiyouga/LLaMA-Factory/wiki",target:"_blank",rel:"noopener"},"\u4F7F\u7528\u6307\u5357")]),n("li",null,[n("strong",null,"\u8BBA\u6587\u53C2\u8003"),a("\uFF1A"),n("a",{href:"https://arxiv.org/abs/2106.09685",target:"_blank",rel:"noopener"},"LoRA: Low-Rank Adaptation")])]),n("h3",{id:"\u5B66\u4E60\u8D44\u6E90",tabindex:"-1"},[a("\u5B66\u4E60\u8D44\u6E90 "),n("a",{class:"header-anchor",href:"#\u5B66\u4E60\u8D44\u6E90","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"QLoRA \u8BBA\u6587"),a("\uFF1A"),n("a",{href:"https://arxiv.org/abs/2305.14314",target:"_blank",rel:"noopener"},"QLoRA: Efficient Finetuning of Quantized LLMs")]),n("li",null,[n("strong",null,"RLHF \u7EFC\u8FF0"),a("\uFF1A"),n("a",{href:"https://arxiv.org/abs/2203.02155",target:"_blank",rel:"noopener"},"Training language models to follow instructions")]),n("li",null,[n("strong",null,"\u6DF7\u5408\u7CBE\u5EA6\u8BAD\u7EC3"),a("\uFF1A"),n("a",{href:"https://arxiv.org/abs/1710.03740",target:"_blank",rel:"noopener"},"Mixed Precision Training")])]),n("h3",{id:"\u793E\u533A\u652F\u6301",tabindex:"-1"},[a("\u793E\u533A\u652F\u6301 "),n("a",{class:"header-anchor",href:"#\u793E\u533A\u652F\u6301","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"\u8BA8\u8BBA\u533A"),a("\uFF1AGitHub Issues \u548C Discussions")]),n("li",null,[n("strong",null,"\u6280\u672F\u535A\u5BA2"),a("\uFF1A\u76F8\u5173\u6280\u672F\u6587\u7AE0\u548C\u6700\u4F73\u5B9E\u8DF5\u5206\u4EAB")]),n("li",null,[n("strong",null,"\u89C6\u9891\u6559\u7A0B"),a("\uFF1AB \u7AD9\u3001YouTube \u7B49\u5E73\u53F0\u7684\u6559\u5B66\u89C6\u9891")])]),n("h2",{id:"\u603B\u7ED3",tabindex:"-1"},[a("\u603B\u7ED3 "),n("a",{class:"header-anchor",href:"#\u603B\u7ED3","aria-hidden":"true"},"#")]),n("p",null,"LLaMA Factory \u4F5C\u4E3A\u4E00\u4E2A\u6210\u719F\u7684\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u6846\u67B6\uFF0C\u63D0\u4F9B\u4E86\u4ECE\u6570\u636E\u5904\u7406\u5230\u6A21\u578B\u90E8\u7F72\u7684\u5B8C\u6574\u89E3\u51B3\u65B9\u6848\u3002\u5B83\u7684\u6838\u5FC3\u4F18\u52BF\u5728\u4E8E\uFF1A"),n("p",null,[n("strong",null,"\u6280\u672F\u4F18\u52BF"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u652F\u6301\u591A\u79CD\u4E3B\u6D41\u6A21\u578B\u67B6\u6784"),n("li",null,"\u96C6\u6210\u5148\u8FDB\u7684\u53C2\u6570\u9AD8\u6548\u5FAE\u8C03\u6280\u672F"),n("li",null,"\u63D0\u4F9B\u5B8C\u6574\u7684 RLHF \u8BAD\u7EC3\u6D41\u7A0B"),n("li",null,"\u4F18\u79C0\u7684\u5185\u5B58\u548C\u8BA1\u7B97\u6548\u7387")]),n("p",null,[n("strong",null,"\u6613\u7528\u6027"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u53CB\u597D\u7684 Web UI \u754C\u9762"),n("li",null,"\u7075\u6D3B\u7684\u914D\u7F6E\u7CFB\u7EDF"),n("li",null,"\u4E30\u5BCC\u7684\u5185\u7F6E\u6570\u636E\u96C6"),n("li",null,"\u8BE6\u7EC6\u7684\u6587\u6863\u548C\u793A\u4F8B")]),n("p",null,[n("strong",null,"\u751F\u6001\u5B8C\u6574\u6027"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u4E0E\u4E3B\u6D41\u6DF1\u5EA6\u5B66\u4E60\u6846\u67B6\u65E0\u7F1D\u96C6\u6210"),n("li",null,"\u652F\u6301\u591A\u79CD\u90E8\u7F72\u65B9\u5F0F"),n("li",null,"\u6D3B\u8DC3\u7684\u793E\u533A\u652F\u6301")]),n("p",null,"\u5BF9\u4E8E\u9700\u8981\u8FDB\u884C\u5927\u8BED\u8A00\u6A21\u578B\u5FAE\u8C03\u7684\u5F00\u53D1\u8005\u548C\u7814\u7A76\u8005\u6765\u8BF4\uFF0CLLaMA Factory \u662F\u4E00\u4E2A\u503C\u5F97\u63A8\u8350\u7684\u5DE5\u5177\u9009\u62E9\u3002\u5B83\u964D\u4F4E\u4E86\u6280\u672F\u95E8\u69DB\uFF0C\u63D0\u9AD8\u4E86\u5F00\u53D1\u6548\u7387\uFF0C\u4F7F\u5F97\u66F4\u591A\u4EBA\u80FD\u591F\u53C2\u4E0E\u5230\u5927\u8BED\u8A00\u6A21\u578B\u7684\u5E94\u7528\u548C\u7814\u7A76\u4E2D\u6765\u3002")],-1)])]),_:1})}}};export{y as date,x as default,L as meta,b as title,f as type};
