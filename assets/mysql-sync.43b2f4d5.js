import{_ as o}from"./Post.dd5dd46a.js";import{u as c,c as r,w as p,o as i,a as n,b as a}from"./app.038d67a7.js";var u="/images/blog/mysql-sync/replication-diagram.png",k="/images/blog/mysql-sync/master.png",m="/images/blog/mysql-sync/success.png";const y="MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)",T="2025-03-01T00:00:00.000Z",_=!0,E="zh",v=[{property:"og:title",content:"MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)"}],A={__name:"mysql-sync",setup(d,{expose:l}){const s={title:"MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)",date:"2025-03-01T00:00:00.000Z",draft:!0,lang:"zh",meta:[{property:"og:title",content:"MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)"}]};return l({frontmatter:s}),c({title:"MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)",meta:[{property:"og:title",content:"MySQL\u4E3B\u4ECE\u6570\u636E\u5E93\u540C\u6B65(Docker\u90E8\u7F72)"}]}),(S,e)=>{const t=o;return i(),r(t,{frontmatter:s},{default:p(()=>[...e[0]||(e[0]=[n("div",{class:"prose m-auto"},[n("h1",{id:"mysql\u4E3B\u4ECE\u540C\u6B65\u539F\u7406\u4E0Edocker\u5B9E\u73B0",tabindex:"-1"},[a("MySQL\u4E3B\u4ECE\u540C\u6B65\u539F\u7406\u4E0EDocker\u5B9E\u73B0 "),n("a",{class:"header-anchor",href:"#mysql\u4E3B\u4ECE\u540C\u6B65\u539F\u7406\u4E0Edocker\u5B9E\u73B0","aria-hidden":"true"},"#")]),n("p",null,"MySQL\u4E3B\u4ECE\u590D\u5236\uFF08Replication\uFF09\u662F\u4E00\u79CD\u5E38\u89C1\u7684\u6570\u636E\u5E93\u9AD8\u53EF\u7528\u6027\u89E3\u51B3\u65B9\u6848\uFF0C\u5B83\u5141\u8BB8\u6570\u636E\u4ECE\u4E00\u4E2AMySQL\u6570\u636E\u5E93\u670D\u52A1\u5668\uFF08\u4E3B\u670D\u52A1\u5668\uFF09\u590D\u5236\u5230\u4E00\u4E2A\u6216\u591A\u4E2AMySQL\u6570\u636E\u5E93\u670D\u52A1\u5668\uFF08\u4ECE\u670D\u52A1\u5668\uFF09\u3002\u4E3B\u4ECE\u590D\u5236\u4E0D\u4EC5\u63D0\u9AD8\u4E86\u6570\u636E\u7684\u5B89\u5168\u6027\uFF0C\u8FD8\u53EF\u4EE5\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\uFF0C\u63D0\u5347\u6574\u4F53\u7CFB\u7EDF\u6027\u80FD\u3002"),n("p",null,"\u672C\u6587\u5C06\u4ECB\u7ECD\u5982\u4F55\u4F7F\u7528Docker\u5BB9\u5668\u5FEB\u901F\u642D\u5EFAMySQL\u4E3B\u4ECE\u540C\u6B65\u73AF\u5883\uFF0C\u5B9E\u73B0\u6570\u636E\u7684\u5B9E\u65F6\u590D\u5236\u3002"),n("h2",{id:"\u4E3B\u4ECE\u590D\u5236\u539F\u7406",tabindex:"-1"},[a("\u4E3B\u4ECE\u590D\u5236\u539F\u7406 "),n("a",{class:"header-anchor",href:"#\u4E3B\u4ECE\u590D\u5236\u539F\u7406","aria-hidden":"true"},"#")]),n("p",null,"MySQL\u4E3B\u4ECE\u590D\u5236\u7684\u57FA\u672C\u539F\u7406\uFF1A"),n("ol",null,[n("li",null,[n("strong",null,"\u4E3B\u5E93\u8BB0\u5F55binlog"),a("\uFF1A\u5F53\u4E3B\u5E93\u4E0A\u53D1\u751F\u6570\u636E\u4FEE\u6539\u64CD\u4F5C\u65F6\uFF0C\u4F1A\u8BB0\u5F55\u5230\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF08binary log\uFF09\u4E2D")]),n("li",null,[n("strong",null,"\u4ECE\u5E93\u8BFB\u53D6binlog"),a("\uFF1A\u4ECE\u5E93\u901A\u8FC7I/O\u7EBF\u7A0B\u8BF7\u6C42\u4E3B\u5E93\u7684binlog\uFF0C\u5E76\u5C06\u5176\u62F7\u8D1D\u5230\u672C\u5730\u7684\u4E2D\u7EE7\u65E5\u5FD7\uFF08relay log\uFF09")]),n("li",null,[n("strong",null,"\u4ECE\u5E93\u56DE\u653E\u65E5\u5FD7"),a("\uFF1A\u4ECE\u5E93\u901A\u8FC7SQL\u7EBF\u7A0B\u8BFB\u53D6\u4E2D\u7EE7\u65E5\u5FD7\u4E2D\u7684\u4E8B\u4EF6\uFF0C\u5E76\u5728\u672C\u5730\u91CD\u653E\uFF0C\u4ECE\u800C\u5B9E\u73B0\u6570\u636E\u540C\u6B65")])]),n("p",null,[n("img",{src:u,alt:"MySQL\u590D\u5236\u539F\u7406"})]),n("h1",{id:"\u90E8\u7F72\u4E3B\u6570\u636E\u5E93",tabindex:"-1"},[a("\u90E8\u7F72\u4E3B\u6570\u636E\u5E93 "),n("a",{class:"header-anchor",href:"#\u90E8\u7F72\u4E3B\u6570\u636E\u5E93","aria-hidden":"true"},"#")]),n("h2",{id:"\u4E3B\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3",tabindex:"-1"},[a("\u4E3B\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3 "),n("a",{class:"header-anchor",href:"#\u4E3B\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3","aria-hidden":"true"},"#")]),n("p",null,"\u521B\u5EFA\u4E3B\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\uFF08my.cnf\uFF09\uFF1A"),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token punctuation"},"["),a("mysqld"),n("span",{class:"token punctuation"},"]"),a(`
datadir `),n("span",{class:"token operator"},"="),a(` /xxx/master1/data
`),n("span",{class:"token comment"},"# \u670D\u52A1\u5668\u552F\u4E00id\uFF0C\u9ED8\u8BA4\u503C1\uFF0C\u5728\u590D\u5236\u62D3\u6251\u4E2D\u5FC5\u987B\u552F\u4E00"),a(`
server-id`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"1"),a(`
`),n("span",{class:"token comment"},"# \u8BBE\u7F6E\u65E5\u5FD7\u683C\u5F0F\uFF0C\u53EF\u9009\u503C\uFF1ASTATEMENT, ROW, MIXED"),a(`
`),n("span",{class:"token comment"},"# STATEMENT: \u8BB0\u5F55SQL\u8BED\u53E5\uFF0C\u53EF\u80FD\u5BFC\u81F4\u4E3B\u4ECE\u4E0D\u4E00\u81F4"),a(`
`),n("span",{class:"token comment"},"# ROW: \u8BB0\u5F55\u884C\u6570\u636E\u53D8\u5316\uFF0C\u66F4\u5B89\u5168\u4F46\u65E5\u5FD7\u91CF\u5927"),a(`
`),n("span",{class:"token comment"},"# MIXED: MySQL\u81EA\u52A8\u9009\u62E9\u5408\u9002\u7684\u683C\u5F0F"),a(`
`),n("span",{class:"token assign-left variable"},"binlog_format"),n("span",{class:"token operator"},"="),a(`STATEMENT
`),n("span",{class:"token comment"},"# \u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u540D\u524D\u7F00"),a(`
log-bin`),n("span",{class:"token operator"},"="),a(`binlog
`),n("span",{class:"token comment"},"# \u542F\u7528GTID\u6A21\u5F0F\uFF08\u53EF\u9009\uFF0CMySQL 5.6\u53CA\u4EE5\u4E0A\u7248\u672C\u652F\u6301\uFF09"),a(`
`),n("span",{class:"token comment"},"# gtid_mode=ON"),a(`
`),n("span",{class:"token comment"},"# enforce_gtid_consistency=ON"),a(`
`),n("span",{class:"token comment"},"# \u6307\u5B9A\u9700\u8981\u590D\u5236\u7684\u6570\u636E\u5E93\uFF08\u53EF\u9009\uFF09"),a(`
`),n("span",{class:"token comment"},"# binlog-do-db=db_name"),a(`
`),n("span",{class:"token comment"},"# \u6307\u5B9A\u4E0D\u9700\u8981\u590D\u5236\u7684\u6570\u636E\u5E93\uFF08\u53EF\u9009\uFF09"),a(`
`),n("span",{class:"token comment"},"# binlog-ignore-db=mysql"),a(`
`)])]),n("h2",{id:"docker-\u90E8\u7F72\u4E3B\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3",tabindex:"-1"},[a("docker \u90E8\u7F72\u4E3B\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3 "),n("a",{class:"header-anchor",href:"#docker-\u90E8\u7F72\u4E3B\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token function"},"docker"),a(" run "),n("span",{class:"token parameter variable"},"--name"),n("span",{class:"token operator"},"="),a("mysql-master-1 "),n("span",{class:"token punctuation"},"\\"),a(`
`),n("span",{class:"token parameter variable"},"--privileged"),n("span",{class:"token operator"},"="),a("true "),n("span",{class:"token punctuation"},"\\"),a("                    "),n("span",{class:"token comment"},"# \u7ED9\u4E88\u5BB9\u5668\u7279\u6743\u6A21\u5F0F"),a(`
`),n("span",{class:"token parameter variable"},"-p"),a(),n("span",{class:"token number"},"8808"),a(":3306 "),n("span",{class:"token punctuation"},"\\"),a("                         "),n("span",{class:"token comment"},"# \u6620\u5C04\u7AEF\u53E3\uFF0C\u4E3B\u673A8808\u6620\u5C04\u5230\u5BB9\u56683306"),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/master1/data/:/var/lib/mysql "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u6570\u636E\u76EE\u5F55"),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/master1/conf/my.cnf:/etc/mysql/my.cnf "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u914D\u7F6E\u6587\u4EF6"),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/master1/mysql-files/:/var/lib/mysql-files/ "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u6587\u4EF6\u76EE\u5F55"),a(`
`),n("span",{class:"token parameter variable"},"-e"),a(),n("span",{class:"token assign-left variable"},"MYSQL_ROOT_PASSWORD"),n("span",{class:"token operator"},"="),a("root "),n("span",{class:"token punctuation"},"\\"),a("          "),n("span",{class:"token comment"},"# \u8BBE\u7F6Eroot\u5BC6\u7801"),a(`
`),n("span",{class:"token parameter variable"},"-d"),a(" mysql:8.0 "),n("span",{class:"token punctuation"},"\\"),a("                         "),n("span",{class:"token comment"},"# \u4F7F\u7528mysql:8.0\u955C\u50CF\u540E\u53F0\u8FD0\u884C"),a(`
`),n("span",{class:"token parameter variable"},"--lower_case_table_names"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"1"),a("             "),n("span",{class:"token comment"},"# \u8BBE\u7F6E\u8868\u540D\u4E0D\u533A\u5206\u5927\u5C0F\u5199"),a(`
`)])]),n("p",null,[n("strong",null,"\u6CE8\u610F"),a("\uFF1A\u5728\u5B9E\u9645\u90E8\u7F72\u4E2D\uFF0C\u8BF7\u5C06 "),n("code",null,"/xxx/"),a(" \u66FF\u6362\u4E3A\u60A8\u81EA\u5DF1\u7684\u5B9E\u9645\u76EE\u5F55\u8DEF\u5F84\u3002")]),n("h1",{id:"\u90E8\u7F72\u4ECE\u6570\u636E\u5E93",tabindex:"-1"},[a("\u90E8\u7F72\u4ECE\u6570\u636E\u5E93 "),n("a",{class:"header-anchor",href:"#\u90E8\u7F72\u4ECE\u6570\u636E\u5E93","aria-hidden":"true"},"#")]),n("h2",{id:"\u4ECE\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3",tabindex:"-1"},[a("\u4ECE\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3 "),n("a",{class:"header-anchor",href:"#\u4ECE\u6570\u636E\u5E93\u914D\u7F6E\u6587\u4EF6\u8BE6\u89E3","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token punctuation"},"["),a("mysqld"),n("span",{class:"token punctuation"},"]"),a(`
datadir `),n("span",{class:"token operator"},"="),a(` /xxx/slave1/data
`),n("span",{class:"token comment"},"# \u670D\u52A1\u5668\u552F\u4E00id\uFF0C\u5FC5\u987B\u4E0E\u4E3B\u5E93\u4E0D\u540C"),a(`
server-id`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"2"),a(`
`),n("span",{class:"token comment"},"# \u542F\u7528\u4E2D\u7EE7\u65E5\u5FD7\uFF0C\u8BB0\u5F55\u4ECE\u4E3B\u5E93\u590D\u5236\u7684\u4E8B\u4EF6"),a(`
relay-log`),n("span",{class:"token operator"},"="),a(`slave-relay-bin
`),n("span",{class:"token comment"},"# \u542F\u7528\u4ECE\u5E93\u66F4\u65B0\u65E5\u5FD7\uFF08\u53EF\u9009\uFF09"),a(`
log-bin`),n("span",{class:"token operator"},"="),a(`slave-bin
`),n("span",{class:"token comment"},"# \u5141\u8BB8\u4ECE\u5E93\u5C06\u66F4\u6539\u5199\u5165\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF08\u7528\u4E8E\u7EA7\u8054\u590D\u5236\uFF09"),a(`
log-slave-updates`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"1"),a(`
`),n("span",{class:"token comment"},"# \u53EA\u8BFB\u6A21\u5F0F\uFF0C\u9632\u6B62\u610F\u5916\u5199\u5165"),a(`
`),n("span",{class:"token assign-left variable"},"read_only"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"1"),a(`
`)])]),n("h2",{id:"docker-\u90E8\u7F72\u4ECE\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3",tabindex:"-1"},[a("docker \u90E8\u7F72\u4ECE\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3 "),n("a",{class:"header-anchor",href:"#docker-\u90E8\u7F72\u4ECE\u6570\u636E\u5E93\u547D\u4EE4\u8BE6\u89E3","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token function"},"docker"),a(" run "),n("span",{class:"token parameter variable"},"--name"),n("span",{class:"token operator"},"="),a("mysql-slave-1 "),n("span",{class:"token punctuation"},"\\"),a(`
`),n("span",{class:"token parameter variable"},"--privileged"),n("span",{class:"token operator"},"="),a("true "),n("span",{class:"token punctuation"},"\\"),a("                   "),n("span",{class:"token comment"},"# \u7ED9\u4E88\u5BB9\u5668\u7279\u6743\u6A21\u5F0F"),a(`
`),n("span",{class:"token parameter variable"},"-p"),a(),n("span",{class:"token number"},"8809"),a(":3306 "),n("span",{class:"token punctuation"},"\\"),a("                        "),n("span",{class:"token comment"},"# \u6620\u5C04\u7AEF\u53E3\uFF0C\u4E3B\u673A8809\u6620\u5C04\u5230\u5BB9\u56683306"),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/slave1/data/:/var/lib/mysql "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u6570\u636E\u76EE\u5F55  "),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/slave1/conf/my.cnf:/etc/mysql/my.cnf "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u914D\u7F6E\u6587\u4EF6"),a(`
`),n("span",{class:"token parameter variable"},"-v"),a(" /xxx/slave1/mysql-files/:/var/lib/mysql-files/ "),n("span",{class:"token punctuation"},"\\"),a(),n("span",{class:"token comment"},"# \u6302\u8F7D\u6587\u4EF6\u76EE\u5F55"),a(`
`),n("span",{class:"token parameter variable"},"-e"),a(),n("span",{class:"token assign-left variable"},"MYSQL_ROOT_PASSWORD"),n("span",{class:"token operator"},"="),a("root "),n("span",{class:"token punctuation"},"\\"),a("         "),n("span",{class:"token comment"},"# \u8BBE\u7F6Eroot\u5BC6\u7801"),a(`
`),n("span",{class:"token parameter variable"},"-d"),a(" mysql:8.0 "),n("span",{class:"token punctuation"},"\\"),a("                        "),n("span",{class:"token comment"},"# \u4F7F\u7528mysql:8.0\u955C\u50CF\u540E\u53F0\u8FD0\u884C"),a(`
`),n("span",{class:"token parameter variable"},"--lower_case_table_names"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"1"),a("            "),n("span",{class:"token comment"},"# \u8BBE\u7F6E\u8868\u540D\u4E0D\u533A\u5206\u5927\u5C0F\u5199"),a(`
`)])]),n("h1",{id:"\u914D\u7F6E\u4E3B\u4ECE\u540C\u6B65",tabindex:"-1"},[a("\u914D\u7F6E\u4E3B\u4ECE\u540C\u6B65 "),n("a",{class:"header-anchor",href:"#\u914D\u7F6E\u4E3B\u4ECE\u540C\u6B65","aria-hidden":"true"},"#")]),n("h2",{id:"\u4E3B\u6570\u636E\u5E93\u914D\u7F6E",tabindex:"-1"},[a("\u4E3B\u6570\u636E\u5E93\u914D\u7F6E "),n("a",{class:"header-anchor",href:"#\u4E3B\u6570\u636E\u5E93\u914D\u7F6E","aria-hidden":"true"},"#")]),n("ol",null,[n("li",null,"\u9996\u5148\uFF0C\u8FDB\u5165\u4E3B\u6570\u636E\u5E93\u5BB9\u5668\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token function"},"docker"),a(),n("span",{class:"token builtin class-name"},"exec"),a(),n("span",{class:"token parameter variable"},"-it"),a(` mysql-master-1 /bin/bash
`)])]),n("ol",{start:"2"},[n("li",null,"\u767B\u5F55MySQL\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[a("mysql "),n("span",{class:"token parameter variable"},"-uroot"),a(),n("span",{class:"token parameter variable"},"-proot"),a(),n("span",{class:"token comment"},"# \u767B\u5F55"),a(`
`)])]),n("ol",{start:"3"},[n("li",null,"\u521B\u5EFA\u7528\u4E8E\u590D\u5236\u7684\u4E13\u7528\u8D26\u6237\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token comment"},"# \u521B\u5EFA\u7528\u4E8E\u590D\u5236\u7684\u7528\u6237\uFF0C\u63A8\u8350\u521B\u5EFA\u4E13\u7528\u7528\u6237\u800C\u975E\u4F7F\u7528root"),a(`
CREATE `),n("span",{class:"token environment constant"},"USER"),a(),n("span",{class:"token string"},"'slave'"),a("@"),n("span",{class:"token string"},"'%'"),a(" IDENTIFIED WITH mysql_native_password BY "),n("span",{class:"token string"},"'123456'"),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u6388\u4E88\u590D\u5236\u6240\u9700\u7684\u6743\u9650"),a(`
GRANT REPLICATION SLAVE ON *.* TO `),n("span",{class:"token string"},"'slave'"),a("@"),n("span",{class:"token string"},"'%'"),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u5237\u65B0\u6743\u9650"),a(`
FLUSH PRIVILEGES`),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u786E\u8BA4\u670D\u52A1\u5668ID\u8BBE\u7F6E\u6B63\u786E"),a(`
SHOW VARIABLES LIKE `),n("span",{class:"token string"},"'server_id'"),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u67E5\u770B\u4E3B\u5E93\u72B6\u6001\uFF0C\u8BB0\u4E0BFile\u548CPosition\u7684\u503C\uFF0C\u540E\u7EED\u914D\u7F6E\u4ECE\u5E93\u65F6\u9700\u8981"),a(`
SHOW MASTER STATUS`),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("p",null,"\u8F93\u51FA\u7ED3\u679C\u7C7B\u4F3C\u4E8E\uFF1A"),n("p",null,[n("img",{src:k,alt:"\u4E3B\u6570\u636E\u5E93\u72B6\u6001"})]),n("p",null,[n("strong",null,"\u91CD\u8981\u63D0\u793A"),a("\uFF1A\u8BB0\u5F55\u4E0B "),n("code",null,"File"),a(" \u548C "),n("code",null,"Position"),a(" \u7684\u503C\uFF0C\u914D\u7F6E\u4ECE\u5E93\u65F6\u9700\u8981\u7528\u5230\u3002")]),n("h2",{id:"\u4ECE\u6570\u636E\u5E93\u914D\u7F6E",tabindex:"-1"},[a("\u4ECE\u6570\u636E\u5E93\u914D\u7F6E "),n("a",{class:"header-anchor",href:"#\u4ECE\u6570\u636E\u5E93\u914D\u7F6E","aria-hidden":"true"},"#")]),n("ol",null,[n("li",null,"\u8FDB\u5165\u4ECE\u6570\u636E\u5E93\u5BB9\u5668\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token function"},"docker"),a(),n("span",{class:"token builtin class-name"},"exec"),a(),n("span",{class:"token parameter variable"},"-it"),a(` mysql-slave-1 /bin/bash
`)])]),n("ol",{start:"2"},[n("li",null,"\u767B\u5F55MySQL\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[a("mysql "),n("span",{class:"token parameter variable"},"-uroot"),a(),n("span",{class:"token parameter variable"},"-proot"),a(),n("span",{class:"token comment"},"# \u767B\u5F55"),a(`
`)])]),n("ol",{start:"3"},[n("li",null,"\u914D\u7F6E\u590D\u5236\uFF1A")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token comment"},"# \u786E\u8BA4\u670D\u52A1\u5668ID\u8BBE\u7F6E\u6B63\u786E\u4E14\u4E0E\u4E3B\u5E93\u4E0D\u540C"),a(`
SHOW VARIABLES LIKE `),n("span",{class:"token string"},"'server_id'"),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u5982\u679Cserver_id\u672A\u6B63\u786E\u8BBE\u7F6E\uFF0C\u53EF\u4EE5\u52A8\u6001\u4FEE\u6539"),a(`
SET GLOBAL server_id `),n("span",{class:"token operator"},"="),a(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u5982\u679C\u4E4B\u524D\u914D\u7F6E\u8FC7\u590D\u5236\uFF0C\u9700\u8981\u5148\u505C\u6B62\u5E76\u91CD\u7F6E"),a(`
STOP SLAVE`),n("span",{class:"token punctuation"},";"),a(`
RESET SLAVE`),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u914D\u7F6E\u4E3B\u5E93\u8FDE\u63A5\u4FE1\u606F"),a(`
CHANGE MASTER TO 
    `),n("span",{class:"token assign-left variable"},"MASTER_HOST"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'172.17.0.2'"),a(",        "),n("span",{class:"token comment"},"# \u4E3B\u5E93\u5BB9\u5668IP\uFF0C\u4E0D\u80FD\u4F7F\u7528127.0.0.1"),a(`
    `),n("span",{class:"token assign-left variable"},"MASTER_PORT"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"3306"),a(",                "),n("span",{class:"token comment"},"# \u4E3B\u5E93MySQL\u7AEF\u53E3\uFF08\u5BB9\u5668\u5185\u7AEF\u53E3\uFF09"),a(`
    `),n("span",{class:"token assign-left variable"},"MASTER_USER"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'slave'"),a(",             "),n("span",{class:"token comment"},"# \u4E3B\u5E93\u590D\u5236\u7528\u6237\u540D"),a(`
    `),n("span",{class:"token assign-left variable"},"MASTER_PASSWORD"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'123456'"),a(",        "),n("span",{class:"token comment"},"# \u4E3B\u5E93\u590D\u5236\u7528\u6237\u5BC6\u7801"),a(`
    `),n("span",{class:"token assign-left variable"},"MASTER_LOG_FILE"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'binlog.000001'"),a(", "),n("span",{class:"token comment"},"# \u4E3B\u5E93\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u540D\uFF08\u4ECESHOW MASTER STATUS\u83B7\u53D6\uFF09"),a(`
    `),n("span",{class:"token assign-left variable"},"MASTER_LOG_POS"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"801"),n("span",{class:"token punctuation"},";"),a("              "),n("span",{class:"token comment"},"# \u4E3B\u5E93\u4E8C\u8FDB\u5236\u65E5\u5FD7\u4F4D\u7F6E\uFF08\u4ECESHOW MASTER STATUS\u83B7\u53D6\uFF09"),a(`

`),n("span",{class:"token comment"},"# \u542F\u52A8\u4ECE\u5E93\u590D\u5236\u7EBF\u7A0B"),a(`
START SLAVE`),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token comment"},"# \u67E5\u770B\u4ECE\u5E93\u72B6\u6001"),a(`
SHOW SLAVE STATUS`),n("span",{class:"token punctuation"},"\\"),a(`G
`)])]),n("p",null,[n("strong",null,"\u6CE8\u610F\u4E8B\u9879"),a("\uFF1A")]),n("ol",null,[n("li",null,[n("code",null,"MASTER_HOST"),a(" \u5FC5\u987B\u4F7F\u7528\u4E3B\u6570\u636E\u5E93\u5BB9\u5668\u7684\u5B9E\u9645IP\u5730\u5740\uFF0C\u800C\u4E0D\u80FD\u4F7F\u7528"),n("code",null,"127.0.0.1"),a("\u6216"),n("code",null,"localhost"),a("\u3002\u53EF\u4EE5\u901A\u8FC7"),n("code",null,"docker inspect mysql-master-1 | grep IPAddress"),a("\u67E5\u770B\u4E3B\u5E93\u5BB9\u5668IP\u3002")]),n("li",null,[n("code",null,"MASTER_PORT"),a(" \u5E94\u8BE5\u662F\u5BB9\u5668\u5185\u7684MySQL\u7AEF\u53E3\uFF08\u9ED8\u8BA43306\uFF09\uFF0C\u4E0D\u662F\u5BBF\u4E3B\u673A\u6620\u5C04\u7AEF\u53E3\u3002")]),n("li",null,[n("code",null,"MASTER_LOG_FILE"),a(" \u548C "),n("code",null,"MASTER_LOG_POS"),a(" \u5FC5\u987B\u4E0E\u4E3B\u5E93\u7684 "),n("code",null,"SHOW MASTER STATUS"),a(" \u8F93\u51FA\u4E00\u81F4\u3002")])]),n("p",null,[a("\u6B63\u786E\u914D\u7F6E\u540E\uFF0C"),n("code",null,"SHOW SLAVE STATUS"),a(" \u8F93\u51FA\u4E2D\u5E94\u8BE5\u80FD\u770B\u5230\uFF1A")]),n("p",null,[n("img",{src:m,alt:"\u4ECE\u5E93\u72B6\u6001\u6210\u529F"})]),n("p",null,"\u786E\u8BA4\u4EE5\u4E0B\u4E24\u9879\u72B6\u6001\u4E3AYes\u8868\u793A\u590D\u5236\u6B63\u5E38\u8FD0\u884C\uFF1A"),n("ul",null,[n("li",null,[n("code",null,"Slave_IO_Running: Yes")]),n("li",null,[n("code",null,"Slave_SQL_Running: Yes")])]),n("h1",{id:"\u6D4B\u8BD5\u4E3B\u4ECE\u540C\u6B65",tabindex:"-1"},[a("\u6D4B\u8BD5\u4E3B\u4ECE\u540C\u6B65 "),n("a",{class:"header-anchor",href:"#\u6D4B\u8BD5\u4E3B\u4ECE\u540C\u6B65","aria-hidden":"true"},"#")]),n("p",null,"\u9A8C\u8BC1\u4E3B\u4ECE\u540C\u6B65\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\uFF1A"),n("ol",null,[n("li",null,"\u5728\u4E3B\u5E93\u521B\u5EFA\u6570\u636E\u5E93\u548C\u8868\uFF1A")]),n("pre",{class:"language-sql"},[n("code",{class:"language-sql"},[n("span",{class:"token comment"},"-- \u5728\u4E3B\u5E93\u6267\u884C"),a(`
`),n("span",{class:"token keyword"},"CREATE"),a(),n("span",{class:"token keyword"},"DATABASE"),a(" test_db"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"USE"),a(" test_db"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"CREATE"),a(),n("span",{class:"token keyword"},"TABLE"),a(" users "),n("span",{class:"token punctuation"},"("),a(`
  id `),n("span",{class:"token keyword"},"INT"),a(),n("span",{class:"token keyword"},"AUTO_INCREMENT"),a(),n("span",{class:"token keyword"},"PRIMARY"),a(),n("span",{class:"token keyword"},"KEY"),n("span",{class:"token punctuation"},","),a(`
  name `),n("span",{class:"token keyword"},"VARCHAR"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),a(`
  create_time `),n("span",{class:"token keyword"},"TIMESTAMP"),a(),n("span",{class:"token keyword"},"DEFAULT"),a(),n("span",{class:"token keyword"},"CURRENT_TIMESTAMP"),a(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"INSERT"),a(),n("span",{class:"token keyword"},"INTO"),a(" users "),n("span",{class:"token punctuation"},"("),a("name"),n("span",{class:"token punctuation"},")"),a(),n("span",{class:"token keyword"},"VALUES"),a(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'user1'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),a(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'user2'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("ol",{start:"2"},[n("li",null,"\u5728\u4ECE\u5E93\u68C0\u67E5\u6570\u636E\u662F\u5426\u540C\u6B65\uFF1A")]),n("pre",{class:"language-sql"},[n("code",{class:"language-sql"},[n("span",{class:"token comment"},"-- \u5728\u4ECE\u5E93\u6267\u884C"),a(`
`),n("span",{class:"token keyword"},"SHOW"),a(),n("span",{class:"token keyword"},"DATABASES"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"USE"),a(" test_db"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"SHOW"),a(),n("span",{class:"token keyword"},"TABLES"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"SELECT"),a(),n("span",{class:"token operator"},"*"),a(),n("span",{class:"token keyword"},"FROM"),a(" users"),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("p",null,"\u5982\u679C\u80FD\u5728\u4ECE\u5E93\u770B\u5230\u4E3B\u5E93\u521B\u5EFA\u7684\u6570\u636E\u5E93\u3001\u8868\u548C\u6570\u636E\uFF0C\u8BF4\u660E\u4E3B\u4ECE\u540C\u6B65\u914D\u7F6E\u6210\u529F\u3002"),n("h1",{id:"\u5E38\u89C1\u95EE\u9898\u4E0E\u6545\u969C\u6392\u9664",tabindex:"-1"},[a("\u5E38\u89C1\u95EE\u9898\u4E0E\u6545\u969C\u6392\u9664 "),n("a",{class:"header-anchor",href:"#\u5E38\u89C1\u95EE\u9898\u4E0E\u6545\u969C\u6392\u9664","aria-hidden":"true"},"#")]),n("h2",{id:"_1-\u4ECE\u5E93\u590D\u5236\u72B6\u6001\u663E\u793A-connecting",tabindex:"-1"},[a('1. \u4ECE\u5E93\u590D\u5236\u72B6\u6001\u663E\u793A"Connecting" '),n("a",{class:"header-anchor",href:"#_1-\u4ECE\u5E93\u590D\u5236\u72B6\u6001\u663E\u793A-connecting","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),a("\uFF1A"),n("code",null,"Slave_IO_Running"),a(' \u663E\u793A "Connecting" \u800C\u4E0D\u662F "Yes"\u3002')]),n("p",null,[n("strong",null,"\u53EF\u80FD\u539F\u56E0"),a("\uFF1A")]),n("ul",null,[n("li",null,"\u7F51\u7EDC\u8FDE\u63A5\u95EE\u9898"),n("li",null,"\u4E3B\u5E93\u5730\u5740\u914D\u7F6E\u9519\u8BEF\uFF08\u4F7F\u7528\u4E86127.0.0.1\uFF09"),n("li",null,"\u8BA4\u8BC1\u5931\u8D25")]),n("p",null,[n("strong",null,"\u89E3\u51B3\u65B9\u6848"),a("\uFF1A")]),n("ul",null,[n("li",null,[a("\u786E\u8BA4\u4E3B\u4ECE\u5BB9\u5668\u7F51\u7EDC\u4E92\u901A\uFF1A"),n("code",null,"ping [\u4E3B\u5E93IP]")]),n("li",null,[a("\u68C0\u67E5\u4E3B\u5E93\u5730\u5740\u914D\u7F6E\uFF1A\u4F7F\u7528"),n("code",null,"docker inspect mysql-master-1 | grep IPAddress"),a("\u83B7\u53D6\u6B63\u786EIP")]),n("li",null,"\u68C0\u67E5\u590D\u5236\u8D26\u6237\u6743\u9650\uFF1A\u786E\u4FDD\u5728\u4E3B\u5E93\u4E0A\u6B63\u786E\u521B\u5EFA\u5E76\u6388\u6743")]),n("h2",{id:"_2-\u590D\u5236\u9519\u8BEF",tabindex:"-1"},[a("2. \u590D\u5236\u9519\u8BEF "),n("a",{class:"header-anchor",href:"#_2-\u590D\u5236\u9519\u8BEF","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),a("\uFF1A"),n("code",null,"Slave_SQL_Running"),a(' \u663E\u793A "No"\u3002')]),n("p",null,[n("strong",null,"\u67E5\u770B\u9519\u8BEF"),a("\uFF1A")]),n("pre",{class:"language-sql"},[n("code",{class:"language-sql"},[n("span",{class:"token keyword"},"SHOW"),a(" SLAVE "),n("span",{class:"token keyword"},"STATUS"),a(`\\G
`)])]),n("p",null,[a("\u68C0\u67E5 "),n("code",null,"Last_SQL_Error"),a(" \u5B57\u6BB5\u7684\u9519\u8BEF\u4FE1\u606F\u3002")]),n("p",null,[n("strong",null,"\u5E38\u89C1\u89E3\u51B3\u65B9\u6848"),a("\uFF1A")]),n("pre",{class:"language-sql"},[n("code",{class:"language-sql"},[n("span",{class:"token comment"},"-- \u8DF3\u8FC7\u5F53\u524D\u9519\u8BEF\uFF08\u8C28\u614E\u4F7F\u7528\uFF0C\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u4E0D\u4E00\u81F4\uFF09"),a(`
STOP SLAVE`),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"SET"),a(),n("span",{class:"token keyword"},"GLOBAL"),a(" SQL_SLAVE_SKIP_COUNTER "),n("span",{class:"token operator"},"="),a(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token keyword"},"START"),a(" SLAVE"),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("h2",{id:"_3-\u4E8C\u8FDB\u5236\u65E5\u5FD7\u683C\u5F0F\u95EE\u9898",tabindex:"-1"},[a("3. \u4E8C\u8FDB\u5236\u65E5\u5FD7\u683C\u5F0F\u95EE\u9898 "),n("a",{class:"header-anchor",href:"#_3-\u4E8C\u8FDB\u5236\u65E5\u5FD7\u683C\u5F0F\u95EE\u9898","aria-hidden":"true"},"#")]),n("p",null,"\u5982\u679C\u4E3B\u5E93\u548C\u4ECE\u5E93\u7684\u8868\u7ED3\u6784\u4E0D\u5B8C\u5168\u4E00\u81F4\uFF0C\u4F7F\u7528STATEMENT\u683C\u5F0F\u53EF\u80FD\u5BFC\u81F4\u590D\u5236\u9519\u8BEF\u3002\u8003\u8651\u6539\u7528ROW\u683C\u5F0F\uFF1A"),n("pre",{class:"language-sql"},[n("code",{class:"language-sql"},[n("span",{class:"token comment"},"-- \u5728\u4E3B\u5E93\u6267\u884C"),a(`
`),n("span",{class:"token keyword"},"SET"),a(),n("span",{class:"token keyword"},"GLOBAL"),a(" binlog_format "),n("span",{class:"token operator"},"="),a(),n("span",{class:"token string"},"'ROW'"),n("span",{class:"token punctuation"},";"),a(`
`),n("span",{class:"token comment"},"-- \u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u5E76\u91CD\u542F\u4EE5\u6301\u4E45\u5316\u8BBE\u7F6E"),a(`
`)])]),n("h1",{id:"\u603B\u7ED3",tabindex:"-1"},[a("\u603B\u7ED3 "),n("a",{class:"header-anchor",href:"#\u603B\u7ED3","aria-hidden":"true"},"#")]),n("p",null,"\u6B63\u786E\u914D\u7F6EMySQL\u4E3B\u4ECE\u590D\u5236\u53EF\u4EE5\u63D0\u9AD8\u7CFB\u7EDF\u7684\u53EF\u7528\u6027\u548C\u6027\u80FD\u3002\u901A\u8FC7Docker\u5BB9\u5668\u90E8\u7F72\u53EF\u4EE5\u5FEB\u901F\u642D\u5EFA\u6D4B\u8BD5\u73AF\u5883\uFF0C\u4F46\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u8FD8\u9700\u8981\u8003\u8651\u6570\u636E\u4E00\u81F4\u6027\u3001\u6545\u969C\u8F6C\u79FB\u7B49\u66F4\u591A\u56E0\u7D20\u3002"),n("p",null,"\u8BB0\u4F4F\u4EE5\u4E0B\u5173\u952E\u70B9\uFF1A"),n("ol",null,[n("li",null,"\u786E\u4FDD\u4E3B\u4ECE\u670D\u52A1\u5668\u7684server-id\u4E0D\u540C"),n("li",null,"\u4F7F\u7528\u6B63\u786E\u7684\u7F51\u7EDC\u8FDE\u63A5\u53C2\u6570"),n("li",null,"\u5B9A\u671F\u68C0\u67E5\u590D\u5236\u72B6\u6001"),n("li",null,"\u6839\u636E\u4E1A\u52A1\u9700\u6C42\u9009\u62E9\u9002\u5F53\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u683C\u5F0F")])],-1)])]),_:1})}}};export{T as date,A as default,_ as draft,E as lang,v as meta,y as title};
