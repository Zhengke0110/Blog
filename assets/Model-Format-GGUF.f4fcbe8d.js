import{_ as l}from"./Post.dd5dd46a.js";import{u as p,c,w as u,o as r,a as n,b as s}from"./app.038d67a7.js";const g="GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F",_="2025-08-14T00:00:00.000Z",f="llm",b=[{property:"og:title",content:"GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F"}],y={__name:"Model-Format-GGUF",setup(i,{expose:o}){const a={title:"GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F",date:"2025-08-14T00:00:00.000Z",type:"llm",meta:[{property:"og:title",content:"GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F"}]};return o({frontmatter:a}),p({title:"GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F",meta:[{property:"og:title",content:"GGUF\uFF1A\u65B0\u4E00\u4EE3\u6A21\u578B\u683C\u5F0F"}]}),(d,t)=>{const e=l;return r(),c(e,{frontmatter:a},{default:u(()=>[...t[0]||(t[0]=[n("div",{class:"prose m-auto"},[n("h2",{id:"\u6982\u8FF0",tabindex:"-1"},[s("\u6982\u8FF0 "),n("a",{class:"header-anchor",href:"#\u6982\u8FF0","aria-hidden":"true"},"#")]),n("p",null,"GGUF (GPT-Generated Unified Format) \u662F\u7531 llama.cpp \u9879\u76EE\u5F00\u53D1\u7684\u65B0\u4E00\u4EE3\u6A21\u578B\u6587\u4EF6\u683C\u5F0F\uFF0C\u4E8E 2023 \u5E74\u63A8\u51FA\uFF0C\u7528\u4E8E\u66FF\u4EE3\u4E4B\u524D\u7684 GGML \u683C\u5F0F\u3002GGUF \u4E13\u4E3A\u9AD8\u6548\u5B58\u50A8\u548C\u52A0\u8F7D\u5927\u8BED\u8A00\u6A21\u578B\u800C\u8BBE\u8BA1\uFF0C\u7279\u522B\u9488\u5BF9 CPU \u63A8\u7406\u4F18\u5316\uFF0C\u652F\u6301\u591A\u79CD\u91CF\u5316\u7CBE\u5EA6\u548C\u5185\u5B58\u6620\u5C04\u6280\u672F\u3002"),n("h2",{id:"\u4E3A\u4EC0\u4E48\u8981\u8F6C\u6362-gguf-\u683C\u5F0F",tabindex:"-1"},[s("\u4E3A\u4EC0\u4E48\u8981\u8F6C\u6362 GGUF \u683C\u5F0F "),n("a",{class:"header-anchor",href:"#\u4E3A\u4EC0\u4E48\u8981\u8F6C\u6362-gguf-\u683C\u5F0F","aria-hidden":"true"},"#")]),n("h3",{id:"\u6838\u5FC3\u9A71\u52A8\u56E0\u7D20",tabindex:"-1"},[s("\u6838\u5FC3\u9A71\u52A8\u56E0\u7D20 "),n("a",{class:"header-anchor",href:"#\u6838\u5FC3\u9A71\u52A8\u56E0\u7D20","aria-hidden":"true"},"#")]),n("p",null,"\u5C06\u6A21\u578B\u8F6C\u6362\u4E3A GGUF \u683C\u5F0F\u7684\u4E3B\u8981\u539F\u56E0\u5305\u62EC\uFF1A"),n("h4",{id:"_1-\u786C\u4EF6\u95E8\u69DB\u964D\u4F4E",tabindex:"-1"},[s("1. "),n("strong",null,"\u786C\u4EF6\u95E8\u69DB\u964D\u4F4E"),s(),n("a",{class:"header-anchor",href:"#_1-\u786C\u4EF6\u95E8\u69DB\u964D\u4F4E","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u95EE\u9898"),s("\uFF1A\u539F\u59CB PyTorch \u6A21\u578B\u5BF9\u786C\u4EF6\u8981\u6C42\u6781\u9AD8")]),n("ul",null,[n("li",null,"7B \u6A21\u578B\u9700\u8981 26GB+ \u663E\u5B58"),n("li",null,"13B \u6A21\u578B\u9700\u8981 49GB+ \u663E\u5B58"),n("li",null,"\u666E\u901A\u6D88\u8D39\u7EA7\u786C\u4EF6\u65E0\u6CD5\u8FD0\u884C")]),n("p",null,[n("strong",null,"\u89E3\u51B3\u65B9\u6848"),s("\uFF1AGGUF \u91CF\u5316\u5927\u5E45\u964D\u4F4E\u8D44\u6E90\u9700\u6C42")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u5185\u5B58\u9700\u6C42\u5BF9\u6BD4"),s(`
model_requirements `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token string"},'"Qwen2.5-7B"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},'"PyTorch FP16"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"14 GB"'),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},'"GGUF Q8_0"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"7.5 GB"'),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},'"GGUF Q4_0"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"4.2 GB"'),s("  "),n("span",{class:"token comment"},"# \u666E\u901A\u7535\u8111\u53EF\u8FD0\u884C"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token string"},'"Qwen2.5-14B"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},'"PyTorch FP16"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"28 GB"'),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},'"GGUF Q8_0"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"15 GB"'),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},'"GGUF Q4_0"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"8.5 GB"'),s("  "),n("span",{class:"token comment"},"# \u9AD8\u7AEF\u6D88\u8D39\u7EA7\u663E\u5361\u53EF\u8FD0\u884C"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("h4",{id:"_2-\u90E8\u7F72\u6210\u672C\u4F18\u5316",tabindex:"-1"},[s("2. "),n("strong",null,"\u90E8\u7F72\u6210\u672C\u4F18\u5316"),s(),n("a",{class:"header-anchor",href:"#_2-\u90E8\u7F72\u6210\u672C\u4F18\u5316","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u4E91\u670D\u52A1\u6210\u672C\u5BF9\u6BD4"),s("\uFF1A")]),n("ul",null,[n("li",null,[n("strong",null,"GPU \u670D\u52A1\u5668"),s("\uFF1A\xA515-60/\u5C0F\u65F6 (A100, H100)")]),n("li",null,[n("strong",null,"CPU \u670D\u52A1\u5668"),s("\uFF1A\xA50.7-3.5/\u5C0F\u65F6")]),n("li",null,[n("strong",null,"\u8FB9\u7F18\u8BBE\u5907"),s("\uFF1A\u4E00\u6B21\u6027\u6295\u5165\uFF0C\u65E0\u6301\u7EED\u8D39\u7528")])]),n("p",null,"GGUF \u672C\u5730\u90E8\u7F72\u5E74\u6210\u672C\u53EF\u8282\u7701 80%+"),n("h4",{id:"_3-\u9690\u79C1\u548C\u5B89\u5168",tabindex:"-1"},[s("3. "),n("strong",null,"\u9690\u79C1\u548C\u5B89\u5168"),s(),n("a",{class:"header-anchor",href:"#_3-\u9690\u79C1\u548C\u5B89\u5168","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u6570\u636E\u5B89\u5168\u9700\u6C42"),s("\uFF1A")]),n("ul",null,[n("li",null,[n("strong",null,"\u91D1\u878D\u884C\u4E1A"),s("\uFF1A\u5BA2\u6237\u6570\u636E\u4E0D\u80FD\u4E0A\u4E91")]),n("li",null,[n("strong",null,"\u533B\u7597\u884C\u4E1A"),s("\uFF1A\u60A3\u8005\u9690\u79C1\u4FDD\u62A4")]),n("li",null,[n("strong",null,"\u4F01\u4E1A\u5185\u90E8"),s("\uFF1A\u5546\u4E1A\u673A\u5BC6\u5B89\u5168")]),n("li",null,[n("strong",null,"\u4E2A\u4EBA\u7528\u6237"),s("\uFF1A\u9690\u79C1\u654F\u611F\u4FE1\u606F")])]),n("p",null,"GGUF \u652F\u6301\u5B8C\u5168\u672C\u5730\u8FD0\u884C\uFF0C\u6570\u636E\u4E0D\u51FA\u8BBE\u5907\u3002"),n("h4",{id:"_4-\u7F51\u7EDC\u4F9D\u8D56\u6D88\u9664",tabindex:"-1"},[s("4. "),n("strong",null,"\u7F51\u7EDC\u4F9D\u8D56\u6D88\u9664"),s(),n("a",{class:"header-anchor",href:"#_4-\u7F51\u7EDC\u4F9D\u8D56\u6D88\u9664","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u79BB\u7EBF\u573A\u666F\u9700\u6C42"),s("\uFF1A")]),n("ul",null,[n("li",null,"\u5DE5\u4E1A\u73B0\u573A\uFF08\u7F51\u7EDC\u4E0D\u7A33\u5B9A\uFF09"),n("li",null,"\u79FB\u52A8\u8BBE\u5907\uFF08\u6D41\u91CF\u9650\u5236\uFF09"),n("li",null,"\u519B\u4E8B/\u7279\u6B8A\u73AF\u5883\uFF08\u7F51\u7EDC\u9694\u79BB\uFF09"),n("li",null,"\u5F00\u53D1\u8C03\u8BD5\uFF08\u65E0\u9700\u8054\u7F51\uFF09")]),n("h4",{id:"_5-\u54CD\u5E94\u5EF6\u8FDF\u4F18\u5316",tabindex:"-1"},[s("5. "),n("strong",null,"\u54CD\u5E94\u5EF6\u8FDF\u4F18\u5316"),s(),n("a",{class:"header-anchor",href:"#_5-\u54CD\u5E94\u5EF6\u8FDF\u4F18\u5316","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u5EF6\u8FDF\u5BF9\u6BD4"),s("\uFF1A")]),n("ul",null,[n("li",null,[n("strong",null,"API \u8C03\u7528"),s("\uFF1A\u7F51\u7EDC\u5EF6\u8FDF + \u4E91\u7AEF\u5904\u7406 \u2248 250ms")]),n("li",null,[n("strong",null,"\u672C\u5730 GGUF"),s("\uFF1A\u4EC5\u672C\u5730\u5904\u7406 \u2248 150ms")])]),n("p",null,"\u672C\u5730\u63A8\u7406\u5EF6\u8FDF\u964D\u4F4E\u7EA6 40%\u3002"),n("h4",{id:"_6-\u5B9A\u5236\u5316\u63A7\u5236",tabindex:"-1"},[s("6. "),n("strong",null,"\u5B9A\u5236\u5316\u63A7\u5236"),s(),n("a",{class:"header-anchor",href:"#_6-\u5B9A\u5236\u5316\u63A7\u5236","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u5B8C\u5168\u63A7\u5236\u6743"),s("\uFF1A")]),n("ul",null,[n("li",null,[n("strong",null,"\u6A21\u578B\u7248\u672C"),s("\uFF1A\u56FA\u5B9A\u6A21\u578B\u7248\u672C\uFF0C\u907F\u514D API \u53D8\u66F4")]),n("li",null,[n("strong",null,"\u8F93\u51FA\u683C\u5F0F"),s("\uFF1A\u81EA\u5B9A\u4E49\u54CD\u5E94\u683C\u5F0F\u548C\u957F\u5EA6")]),n("li",null,[n("strong",null,"\u505C\u6B62\u6761\u4EF6"),s("\uFF1A\u7CBE\u786E\u63A7\u5236\u751F\u6210\u7EC8\u6B62\u6761\u4EF6")]),n("li",null,[n("strong",null,"\u6E29\u5EA6\u53C2\u6570"),s("\uFF1A\u7EC6\u7C92\u5EA6\u8C03\u6574\u521B\u9020\u6027\u8F93\u51FA")])]),n("h3",{id:"\u6838\u5FC3\u7279\u6027",tabindex:"-1"},[s("\u6838\u5FC3\u7279\u6027 "),n("a",{class:"header-anchor",href:"#\u6838\u5FC3\u7279\u6027","aria-hidden":"true"},"#")]),n("p",null,"GGUF \u683C\u5F0F\u7684\u4E3B\u8981\u4F18\u52BF\u5305\u62EC\uFF1A"),n("ol",null,[n("li",null,[n("strong",null,"\u9AD8\u6548\u91CF\u5316"),s("\uFF1A\u652F\u6301\u591A\u79CD\u7CBE\u5EA6\u7684\u6743\u91CD\u91CF\u5316\uFF08Q4_0, Q4_1, Q5_0, Q5_1, Q8_0 \u7B49\uFF09")]),n("li",null,[n("strong",null,"\u5185\u5B58\u6620\u5C04"),s("\uFF1A\u652F\u6301 mmap\uFF0C\u5B9E\u73B0\u5FEB\u901F\u6A21\u578B\u52A0\u8F7D")]),n("li",null,[n("strong",null,"\u8DE8\u5E73\u53F0\u517C\u5BB9"),s("\uFF1A\u7EDF\u4E00\u7684\u4E8C\u8FDB\u5236\u683C\u5F0F\uFF0C\u652F\u6301\u4E0D\u540C\u64CD\u4F5C\u7CFB\u7EDF")]),n("li",null,[n("strong",null,"\u5143\u6570\u636E\u4E30\u5BCC"),s("\uFF1A\u5305\u542B\u5B8C\u6574\u7684\u6A21\u578B\u914D\u7F6E\u548C\u5206\u8BCD\u5668\u4FE1\u606F")]),n("li",null,[n("strong",null,"\u5411\u540E\u517C\u5BB9"),s("\uFF1A\u53EF\u4EE5\u8F6C\u6362\u73B0\u6709\u7684 PyTorch/Safetensors \u6A21\u578B")])]),n("pre",{class:"language-mermaid"},[n("code",{class:"language-mermaid"},[n("span",{class:"token keyword"},"graph"),s(` TB
    A`),n("span",{class:"token text string"},"[\u539F\u59CB\u6A21\u578B<br/>PyTorch/Safetensors]"),s(),n("span",{class:"token arrow operator"},"-->"),s(" B"),n("span",{class:"token text string"},"[GGUF \u8F6C\u6362]"),s(`
    B `),n("span",{class:"token arrow operator"},"-->"),s(" C"),n("span",{class:"token text string"},"[\u91CF\u5316\u9009\u62E9]"),s(`
    C `),n("span",{class:"token arrow operator"},"-->"),s(" D"),n("span",{class:"token text string"},"[GGUF \u6587\u4EF6]"),s(`

    E`),n("span",{class:"token text string"},"[\u6A21\u578B\u6743\u91CD]"),s(),n("span",{class:"token arrow operator"},"-->"),s(" F"),n("span",{class:"token text string"},"[\u91CF\u5316\u538B\u7F29]"),s(`
    G`),n("span",{class:"token text string"},"[\u914D\u7F6E\u4FE1\u606F]"),s(),n("span",{class:"token arrow operator"},"-->"),s(" H"),n("span",{class:"token text string"},"[\u5143\u6570\u636E\u5B58\u50A8]"),s(`
    I`),n("span",{class:"token text string"},"[\u5206\u8BCD\u5668]"),s(),n("span",{class:"token arrow operator"},"-->"),s(" J"),n("span",{class:"token text string"},"[\u8BCD\u6C47\u8868\u5D4C\u5165]"),s(`

    F `),n("span",{class:"token arrow operator"},"-->"),s(` D
    H `),n("span",{class:"token arrow operator"},"-->"),s(` D
    J `),n("span",{class:"token arrow operator"},"-->"),s(` D

    D `),n("span",{class:"token arrow operator"},"-->"),s(" K"),n("span",{class:"token text string"},"[CPU \u63A8\u7406]"),s(`
    D `),n("span",{class:"token arrow operator"},"-->"),s(" L"),n("span",{class:"token text string"},"[GPU \u63A8\u7406]"),s(`
    D `),n("span",{class:"token arrow operator"},"-->"),s(" M"),n("span",{class:"token text string"},"[\u6DF7\u5408\u63A8\u7406]"),s(`

    `),n("span",{class:"token keyword"},"style"),s(" D "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),s("#e8f5e8")]),s(`
    `),n("span",{class:"token keyword"},"style"),s(" K "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),s("#fff3e0")]),s(`
    `),n("span",{class:"token keyword"},"style"),s(" L "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),s("#e3f2fd")]),s(`
    `),n("span",{class:"token keyword"},"style"),s(" M "),n("span",{class:"token style"},[n("span",{class:"token property"},"fill"),n("span",{class:"token operator"},":"),s("#f3e5f5")]),s(`
`)])]),n("h3",{id:"\u6280\u672F\u4F18\u52BF",tabindex:"-1"},[s("\u6280\u672F\u4F18\u52BF "),n("a",{class:"header-anchor",href:"#\u6280\u672F\u4F18\u52BF","aria-hidden":"true"},"#")]),n("p",null,"\u76F8\u6BD4\u4F20\u7EDF\u683C\u5F0F\uFF0CGGUF \u5177\u6709\u663E\u8457\u4F18\u52BF\uFF1A"),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"\u7279\u6027"),n("th",null,"GGUF"),n("th",null,"PyTorch"),n("th",null,"Safetensors")])]),n("tbody",null,[n("tr",null,[n("td",null,"\u7279\u4EF6\u5927\u5C0F"),n("td",null,"\u5C0F\uFF08\u91CF\u5316\uFF09"),n("td",null,"\u5927"),n("td",null,"\u4E2D\u7B49")]),n("tr",null,[n("td",null,"\u52A0\u8F7D\u901F\u5EA6"),n("td",null,"\u5FEB\uFF08mmap\uFF09"),n("td",null,"\u6162"),n("td",null,"\u4E2D\u7B49")]),n("tr",null,[n("td",null,"CPU \u63A8\u7406"),n("td",null,"\u4F18\u5316"),n("td",null,"\u4E00\u822C"),n("td",null,"\u4E00\u822C")]),n("tr",null,[n("td",null,"\u5185\u5B58\u4F7F\u7528"),n("td",null,"\u4F4E"),n("td",null,"\u9AD8"),n("td",null,"\u4E2D\u7B49")]),n("tr",null,[n("td",null,"\u8DE8\u5E73\u53F0"),n("td",null,"\u4F18\u79C0"),n("td",null,"Python \u4F9D\u8D56"),n("td",null,"\u597D")])])]),n("h2",{id:"\u6280\u672F\u539F\u7406",tabindex:"-1"},[s("\u6280\u672F\u539F\u7406 "),n("a",{class:"header-anchor",href:"#\u6280\u672F\u539F\u7406","aria-hidden":"true"},"#")]),n("h3",{id:"\u6587\u4EF6\u7ED3\u6784",tabindex:"-1"},[s("\u6587\u4EF6\u7ED3\u6784 "),n("a",{class:"header-anchor",href:"#\u6587\u4EF6\u7ED3\u6784","aria-hidden":"true"},"#")]),n("p",null,"GGUF \u6587\u4EF6\u91C7\u7528\u4E8C\u8FDB\u5236\u683C\u5F0F\uFF0C\u7531\u4EE5\u4E0B\u90E8\u5206\u7EC4\u6210\uFF1A"),n("pre",{class:"language-text"},[n("code",{class:"language-text"},`\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510
\u2502     \u6587\u4EF6\u5934       \u2502 \u2190 \u9B54\u6570\u3001\u7248\u672C\u3001\u5143\u6570\u636E
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502   \u952E\u503C\u5143\u6570\u636E      \u2502 \u2190 \u6A21\u578B\u914D\u7F6E\u3001\u5206\u8BCD\u5668\u4FE1\u606F
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502   \u5F20\u91CF\u4FE1\u606F       \u2502 \u2190 \u6743\u91CD\u5F20\u91CF\u7684\u5143\u4FE1\u606F
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502   \u586B\u5145\u5BF9\u9F50       \u2502 \u2190 \u5185\u5B58\u5BF9\u9F50\u4F18\u5316
\u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524
\u2502   \u5F20\u91CF\u6570\u636E       \u2502 \u2190 \u5B9E\u9645\u7684\u6743\u91CD\u6570\u636E
\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518
`)]),n("h3",{id:"\u91CF\u5316\u7B97\u6CD5",tabindex:"-1"},[s("\u91CF\u5316\u7B97\u6CD5 "),n("a",{class:"header-anchor",href:"#\u91CF\u5316\u7B97\u6CD5","aria-hidden":"true"},"#")]),n("p",null,"GGUF \u652F\u6301\u591A\u79CD\u91CF\u5316\u65B9\u6CD5\uFF0C\u6BCF\u79CD\u90FD\u6709\u4E0D\u540C\u7684\u7CBE\u5EA6\u548C\u538B\u7F29\u6BD4\uFF1A"),n("h4",{id:"q4-0-\u91CF\u5316\uFF084-bit\uFF09",tabindex:"-1"},[s("Q4_0 \u91CF\u5316\uFF084-bit\uFF09 "),n("a",{class:"header-anchor",href:"#q4-0-\u91CF\u5316\uFF084-bit\uFF09","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# Q4_0 \u91CF\u5316\u539F\u7406"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"quantize_q4_0"),n("span",{class:"token punctuation"},"("),s("weights"),n("span",{class:"token punctuation"},","),s(" block_size"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token triple-quoted-string string"},'"""4-bit \u91CF\u5316\uFF0C\u6BCF32\u4E2A\u5143\u7D20\u4E00\u7EC4"""'),s(`

    `),n("span",{class:"token comment"},"# \u5C06\u6743\u91CD\u5206\u5757"),s(`
    blocks `),n("span",{class:"token operator"},"="),s(" weights"),n("span",{class:"token punctuation"},"."),s("reshape"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" block_size"),n("span",{class:"token punctuation"},")"),s(`
    quantized_blocks `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    scales `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(" block "),n("span",{class:"token keyword"},"in"),s(" blocks"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token comment"},"# \u8BA1\u7B97\u7F29\u653E\u56E0\u5B50"),s(`
        abs_max `),n("span",{class:"token operator"},"="),s(" torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"max"),n("span",{class:"token punctuation"},"("),s("torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"abs"),n("span",{class:"token punctuation"},"("),s("block"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        scale `),n("span",{class:"token operator"},"="),s(" abs_max "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"7.0"),s("  "),n("span",{class:"token comment"},"# 4-bit \u8303\u56F4\uFF1A-7\u52307"),s(`
        scales`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),s("scale"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u91CF\u5316\u52304-bit"),s(`
        quantized `),n("span",{class:"token operator"},"="),s(" torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"round"),n("span",{class:"token punctuation"},"("),s("block "),n("span",{class:"token operator"},"/"),s(" scale"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("clamp"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"7"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"7"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u6253\u5305\u4E3A4-bit\u5B58\u50A8"),s(`
        packed `),n("span",{class:"token operator"},"="),s(" pack_4bit"),n("span",{class:"token punctuation"},"("),s("quantized"),n("span",{class:"token punctuation"},")"),s(`
        quantized_blocks`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),s("packed"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"return"),s(" quantized_blocks"),n("span",{class:"token punctuation"},","),s(` scales

`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"dequantize_q4_0"),n("span",{class:"token punctuation"},"("),s("quantized_blocks"),n("span",{class:"token punctuation"},","),s(" scales"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token triple-quoted-string string"},'"""\u53CD\u91CF\u5316\u6062\u590D\u6743\u91CD"""'),s(`
    dequantized `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(" packed"),n("span",{class:"token punctuation"},","),s(" scale "),n("span",{class:"token keyword"},"in"),s(),n("span",{class:"token builtin"},"zip"),n("span",{class:"token punctuation"},"("),s("quantized_blocks"),n("span",{class:"token punctuation"},","),s(" scales"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token comment"},"# \u89E3\u53054-bit\u6570\u636E"),s(`
        unpacked `),n("span",{class:"token operator"},"="),s(" unpack_4bit"),n("span",{class:"token punctuation"},"("),s("packed"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u53CD\u91CF\u5316"),s(`
        block `),n("span",{class:"token operator"},"="),s(" unpacked"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"float"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"*"),s(` scale
        dequantized`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),s("block"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"return"),s(" torch"),n("span",{class:"token punctuation"},"."),s("cat"),n("span",{class:"token punctuation"},"("),s("dequantized"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("h4",{id:"q8-0-\u91CF\u5316\uFF088-bit\uFF09",tabindex:"-1"},[s("Q8_0 \u91CF\u5316\uFF088-bit\uFF09 "),n("a",{class:"header-anchor",href:"#q8-0-\u91CF\u5316\uFF088-bit\uFF09","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"quantize_q8_0"),n("span",{class:"token punctuation"},"("),s("weights"),n("span",{class:"token punctuation"},","),s(" block_size"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token triple-quoted-string string"},'"""8-bit \u91CF\u5316\uFF0C\u66F4\u9AD8\u7CBE\u5EA6"""'),s(`

    blocks `),n("span",{class:"token operator"},"="),s(" weights"),n("span",{class:"token punctuation"},"."),s("reshape"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" block_size"),n("span",{class:"token punctuation"},")"),s(`
    quantized_blocks `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    scales `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(" block "),n("span",{class:"token keyword"},"in"),s(" blocks"),n("span",{class:"token punctuation"},":"),s(`
        abs_max `),n("span",{class:"token operator"},"="),s(" torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"max"),n("span",{class:"token punctuation"},"("),s("torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"abs"),n("span",{class:"token punctuation"},"("),s("block"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        scale `),n("span",{class:"token operator"},"="),s(" abs_max "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"127.0"),s("  "),n("span",{class:"token comment"},"# 8-bit \u8303\u56F4\uFF1A-127\u5230127"),s(`
        scales`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),s("scale"),n("span",{class:"token punctuation"},")"),s(`

        quantized `),n("span",{class:"token operator"},"="),s(" torch"),n("span",{class:"token punctuation"},"."),n("span",{class:"token builtin"},"round"),n("span",{class:"token punctuation"},"("),s("block "),n("span",{class:"token operator"},"/"),s(" scale"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("clamp"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"127"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"127"),n("span",{class:"token punctuation"},")"),s(`
        quantized_blocks`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),s("quantized"),n("span",{class:"token punctuation"},"."),s("to"),n("span",{class:"token punctuation"},"("),s("torch"),n("span",{class:"token punctuation"},"."),s("int8"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"return"),s(" quantized_blocks"),n("span",{class:"token punctuation"},","),s(` scales
`)])]),n("h3",{id:"\u5185\u5B58\u6620\u5C04\u6280\u672F",tabindex:"-1"},[s("\u5185\u5B58\u6620\u5C04\u6280\u672F "),n("a",{class:"header-anchor",href:"#\u5185\u5B58\u6620\u5C04\u6280\u672F","aria-hidden":"true"},"#")]),n("p",null,"GGUF \u901A\u8FC7\u5185\u5B58\u6620\u5C04\u5B9E\u73B0\u5FEB\u901F\u52A0\u8F7D\uFF1A"),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token keyword"},"import"),s(` mmap
`),n("span",{class:"token keyword"},"import"),s(" numpy "),n("span",{class:"token keyword"},"as"),s(` np

`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"GGUFLoader"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token triple-quoted-string string"},'"""GGUF \u6587\u4EF6\u52A0\u8F7D\u5668"""'),s(`

    `),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"__init__"),n("span",{class:"token punctuation"},"("),s("self"),n("span",{class:"token punctuation"},","),s(" file_path"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        self`),n("span",{class:"token punctuation"},"."),s("file_path "),n("span",{class:"token operator"},"="),s(` file_path
        self`),n("span",{class:"token punctuation"},"."),s("file_handle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"None"),s(`
        self`),n("span",{class:"token punctuation"},"."),s("mmap_handle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"None"),s(`

    `),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"load_with_mmap"),n("span",{class:"token punctuation"},"("),s("self"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token triple-quoted-string string"},'"""\u4F7F\u7528\u5185\u5B58\u6620\u5C04\u52A0\u8F7D\u6A21\u578B"""'),s(`

        `),n("span",{class:"token comment"},"# \u6253\u5F00\u6587\u4EF6"),s(`
        self`),n("span",{class:"token punctuation"},"."),s("file_handle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token builtin"},"open"),n("span",{class:"token punctuation"},"("),s("self"),n("span",{class:"token punctuation"},"."),s("file_path"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'rb'"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u521B\u5EFA\u5185\u5B58\u6620\u5C04"),s(`
        self`),n("span",{class:"token punctuation"},"."),s("mmap_handle "),n("span",{class:"token operator"},"="),s(" mmap"),n("span",{class:"token punctuation"},"."),s("mmap"),n("span",{class:"token punctuation"},"("),s(`
            self`),n("span",{class:"token punctuation"},"."),s("file_handle"),n("span",{class:"token punctuation"},"."),s("fileno"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},","),s(`
            access`),n("span",{class:"token operator"},"="),s("mmap"),n("span",{class:"token punctuation"},"."),s(`ACCESS_READ
        `),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u89E3\u6790\u6587\u4EF6\u5934"),s(`
        header `),n("span",{class:"token operator"},"="),s(" self"),n("span",{class:"token punctuation"},"."),s("parse_header"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u89E3\u6790\u5143\u6570\u636E"),s(`
        metadata `),n("span",{class:"token operator"},"="),s(" self"),n("span",{class:"token punctuation"},"."),s("parse_metadata"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token comment"},"# \u83B7\u53D6\u5F20\u91CF\u4FE1\u606F\uFF08\u4E0D\u7ACB\u5373\u52A0\u8F7D\u6570\u636E\uFF09"),s(`
        tensor_info `),n("span",{class:"token operator"},"="),s(" self"),n("span",{class:"token punctuation"},"."),s("parse_tensor_info"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"return"),s(" header"),n("span",{class:"token punctuation"},","),s(" metadata"),n("span",{class:"token punctuation"},","),s(` tensor_info

    `),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"get_tensor"),n("span",{class:"token punctuation"},"("),s("self"),n("span",{class:"token punctuation"},","),s(" tensor_name"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token triple-quoted-string string"},'"""\u6309\u9700\u52A0\u8F7D\u7279\u5B9A\u5F20\u91CF"""'),s(`
        tensor_info `),n("span",{class:"token operator"},"="),s(" self"),n("span",{class:"token punctuation"},"."),s("tensor_info"),n("span",{class:"token punctuation"},"["),s("tensor_name"),n("span",{class:"token punctuation"},"]"),s(`

        `),n("span",{class:"token comment"},"# \u76F4\u63A5\u4ECE\u5185\u5B58\u6620\u5C04\u4E2D\u83B7\u53D6\u6570\u636E"),s(`
        offset `),n("span",{class:"token operator"},"="),s(" tensor_info"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'offset'"),n("span",{class:"token punctuation"},"]"),s(`
        size `),n("span",{class:"token operator"},"="),s(" tensor_info"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'size'"),n("span",{class:"token punctuation"},"]"),s(`
        dtype `),n("span",{class:"token operator"},"="),s(" tensor_info"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'dtype'"),n("span",{class:"token punctuation"},"]"),s(`

        `),n("span",{class:"token comment"},"# \u96F6\u62F7\u8D1D\u83B7\u53D6\u6570\u636E"),s(`
        data `),n("span",{class:"token operator"},"="),s(" np"),n("span",{class:"token punctuation"},"."),s("frombuffer"),n("span",{class:"token punctuation"},"("),s(`
            self`),n("span",{class:"token punctuation"},"."),s("mmap_handle"),n("span",{class:"token punctuation"},"["),s("offset"),n("span",{class:"token punctuation"},":"),s("offset"),n("span",{class:"token operator"},"+"),s("size"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
            dtype`),n("span",{class:"token operator"},"="),s(`dtype
        `),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"return"),s(" data"),n("span",{class:"token punctuation"},"."),s("reshape"),n("span",{class:"token punctuation"},"("),s("tensor_info"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'shape'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("h2",{id:"\u5B9E\u73B0\u7EC6\u8282",tabindex:"-1"},[s("\u5B9E\u73B0\u7EC6\u8282 "),n("a",{class:"header-anchor",href:"#\u5B9E\u73B0\u7EC6\u8282","aria-hidden":"true"},"#")]),n("h3",{id:"\u6A21\u578B\u8F6C\u6362",tabindex:"-1"},[s("\u6A21\u578B\u8F6C\u6362 "),n("a",{class:"header-anchor",href:"#\u6A21\u578B\u8F6C\u6362","aria-hidden":"true"},"#")]),n("p",null,"\u57FA\u672C\u8F6C\u6362\u6D41\u7A0B\uFF1A"),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token keyword"},"from"),s(" transformers "),n("span",{class:"token keyword"},"import"),s(" AutoTokenizer"),n("span",{class:"token punctuation"},","),s(` AutoModelForCausalLM
`),n("span",{class:"token keyword"},"import"),s(` gguf

`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"convert_to_gguf"),n("span",{class:"token punctuation"},"("),s("model_name"),n("span",{class:"token punctuation"},","),s(" output_path"),n("span",{class:"token punctuation"},","),s(" quantization"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"q4_0"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token triple-quoted-string string"},'"""\u8F6C\u6362\u6A21\u578B\u4E3A GGUF \u683C\u5F0F"""'),s(`

    `),n("span",{class:"token comment"},"# 1. \u52A0\u8F7D\u539F\u59CB\u6A21\u578B"),s(`
    model `),n("span",{class:"token operator"},"="),s(" AutoModelForCausalLM"),n("span",{class:"token punctuation"},"."),s("from_pretrained"),n("span",{class:"token punctuation"},"("),s("model_name"),n("span",{class:"token punctuation"},")"),s(`
    tokenizer `),n("span",{class:"token operator"},"="),s(" AutoTokenizer"),n("span",{class:"token punctuation"},"."),s("from_pretrained"),n("span",{class:"token punctuation"},"("),s("model_name"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token comment"},"# 2. \u521B\u5EFA GGUF \u5199\u5165\u5668\u5E76\u5199\u5165\u6570\u636E"),s(`
    gguf_writer `),n("span",{class:"token operator"},"="),s(" gguf"),n("span",{class:"token punctuation"},"."),s("GGUFWriter"),n("span",{class:"token punctuation"},"("),s("output_path"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"llama"'),n("span",{class:"token punctuation"},")"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("add_name"),n("span",{class:"token punctuation"},"("),s("model_name"),n("span",{class:"token punctuation"},")"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("add_tokenizer_model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"llama"'),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token comment"},"# 3. \u91CF\u5316\u5E76\u5199\u5165\u6743\u91CD"),s(`
    `),n("span",{class:"token keyword"},"for"),s(" name"),n("span",{class:"token punctuation"},","),s(" tensor "),n("span",{class:"token keyword"},"in"),s(" model"),n("span",{class:"token punctuation"},"."),s("state_dict"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("items"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"if"),s(" quantization "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"q4_0"'),n("span",{class:"token punctuation"},":"),s(`
            quantized_tensor `),n("span",{class:"token operator"},"="),s(" quantize_q4_0"),n("span",{class:"token punctuation"},"("),s("tensor"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},":"),s(`
            quantized_tensor `),n("span",{class:"token operator"},"="),s(` tensor
        gguf_writer`),n("span",{class:"token punctuation"},"."),s("add_tensor"),n("span",{class:"token punctuation"},"("),s("name"),n("span",{class:"token punctuation"},","),s(" quantized_tensor"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token comment"},"# 4. \u5B8C\u6210\u5199\u5165"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("write_header_to_file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("write_kv_data_to_file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("write_tensors_to_file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    gguf_writer`),n("span",{class:"token punctuation"},"."),s("close"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"# \u4F7F\u7528\u793A\u4F8B"),s(`
convert_to_gguf`),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"microsoft/DialoGPT-small"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"model.gguf"'),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("h3",{id:"\u6A21\u578B\u63A8\u7406",tabindex:"-1"},[s("\u6A21\u578B\u63A8\u7406 "),n("a",{class:"header-anchor",href:"#\u6A21\u578B\u63A8\u7406","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token keyword"},"import"),s(` llama_cpp

`),n("span",{class:"token comment"},"# \u52A0\u8F7D\u6A21\u578B"),s(`
llm `),n("span",{class:"token operator"},"="),s(" llama_cpp"),n("span",{class:"token punctuation"},"."),s("Llama"),n("span",{class:"token punctuation"},"("),s(`
    model_path`),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"./models/model.gguf"'),n("span",{class:"token punctuation"},","),s(`
    n_ctx`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"2048"),n("span",{class:"token punctuation"},","),s("      "),n("span",{class:"token comment"},"# \u4E0A\u4E0B\u6587\u957F\u5EA6"),s(`
    n_threads`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),s("     "),n("span",{class:"token comment"},"# \u7EBF\u7A0B\u6570"),s(`
    n_gpu_layers`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"0"),s("   "),n("span",{class:"token comment"},"# CPU\u63A8\u7406"),s(`
`),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"# \u6587\u672C\u751F\u6210"),s(`
response `),n("span",{class:"token operator"},"="),s(" llm"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token string"},'"\u4F60\u597D\uFF0C\u8BF7\u4ECB\u7ECD\u4E00\u4E0BGGUF\u683C\u5F0F"'),n("span",{class:"token punctuation"},","),s(`
    max_tokens`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"100"),n("span",{class:"token punctuation"},","),s(`
    temperature`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"0.7"),s(`
`),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),s("response"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'choices'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'text'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("h2",{id:"\u6027\u80FD\u5206\u6790",tabindex:"-1"},[s("\u6027\u80FD\u5206\u6790 "),n("a",{class:"header-anchor",href:"#\u6027\u80FD\u5206\u6790","aria-hidden":"true"},"#")]),n("h3",{id:"\u91CF\u5316\u7CBE\u5EA6\u5BF9\u6BD4",tabindex:"-1"},[s("\u91CF\u5316\u7CBE\u5EA6\u5BF9\u6BD4 "),n("a",{class:"header-anchor",href:"#\u91CF\u5316\u7CBE\u5EA6\u5BF9\u6BD4","aria-hidden":"true"},"#")]),n("p",null,"\u4E0D\u540C\u91CF\u5316\u65B9\u6CD5\u7684\u6027\u80FD\u7279\u5F81\uFF1A"),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"\u91CF\u5316\u7C7B\u578B"),n("th",null,"\u6BD4\u7279\u6570"),n("th",null,"\u6A21\u578B\u5927\u5C0F\u538B\u7F29"),n("th",null,"\u63A8\u7406\u901F\u5EA6"),n("th",null,"\u7CBE\u5EA6\u635F\u5931"),n("th",null,"\u9002\u7528\u573A\u666F")])]),n("tbody",null,[n("tr",null,[n("td",null,"F16"),n("td",null,"16"),n("td",null,"50%"),n("td",null,"\u4E2D\u7B49"),n("td",null,"\u65E0"),n("td",null,"\u9AD8\u7CBE\u5EA6\u9700\u6C42")]),n("tr",null,[n("td",null,"Q8_0"),n("td",null,"8"),n("td",null,"75%"),n("td",null,"\u5FEB"),n("td",null,"\u5F88\u5C0F"),n("td",null,"\u5E73\u8861\u9009\u62E9")]),n("tr",null,[n("td",null,"Q5_1"),n("td",null,"5"),n("td",null,"80%"),n("td",null,"\u5FEB"),n("td",null,"\u5C0F"),n("td",null,"\u63A8\u8350\u9009\u62E9")]),n("tr",null,[n("td",null,"Q4_1"),n("td",null,"4"),n("td",null,"87.5%"),n("td",null,"\u5F88\u5FEB"),n("td",null,"\u4E2D\u7B49"),n("td",null,"\u8D44\u6E90\u53D7\u9650")]),n("tr",null,[n("td",null,"Q4_0"),n("td",null,"4"),n("td",null,"87.5%"),n("td",null,"\u5F88\u5FEB"),n("td",null,"\u4E2D\u7B49"),n("td",null,"\u6700\u5C0F\u6A21\u578B")])])]),n("h3",{id:"\u6027\u80FD\u4F18\u5316\u5EFA\u8BAE",tabindex:"-1"},[s("\u6027\u80FD\u4F18\u5316\u5EFA\u8BAE "),n("a",{class:"header-anchor",href:"#\u6027\u80FD\u4F18\u5316\u5EFA\u8BAE","aria-hidden":"true"},"#")]),n("p",null,"\u6839\u636E\u786C\u4EF6\u914D\u7F6E\u9009\u62E9\u5408\u9002\u7684\u91CF\u5316\u7EA7\u522B\uFF1A"),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"\u5185\u5B58\u5BB9\u91CF"),n("th",null,"\u63A8\u8350\u91CF\u5316"),n("th",null,"\u4E0A\u4E0B\u6587\u957F\u5EA6"),n("th",null,"\u9002\u7528\u573A\u666F")])]),n("tbody",null,[n("tr",null,[n("td",null,"< 8GB"),n("td",null,"Q4_0"),n("td",null,"1024"),n("td",null,"\u8D44\u6E90\u53D7\u9650")]),n("tr",null,[n("td",null,"8-16GB"),n("td",null,"Q5_1"),n("td",null,"2048"),n("td",null,"\u5E73\u8861\u9009\u62E9")]),n("tr",null,[n("td",null,"> 16GB"),n("td",null,"Q8_0"),n("td",null,"4096"),n("td",null,"\u9AD8\u8D28\u91CF")])])]),n("h2",{id:"\u5B9E\u9645\u5E94\u7528\u6848\u4F8B",tabindex:"-1"},[s("\u5B9E\u9645\u5E94\u7528\u6848\u4F8B "),n("a",{class:"header-anchor",href:"#\u5B9E\u9645\u5E94\u7528\u6848\u4F8B","aria-hidden":"true"},"#")]),n("h3",{id:"\u672C\u5730\u90E8\u7F72\u793A\u4F8B",tabindex:"-1"},[s("\u672C\u5730\u90E8\u7F72\u793A\u4F8B "),n("a",{class:"header-anchor",href:"#\u672C\u5730\u90E8\u7F72\u793A\u4F8B","aria-hidden":"true"},"#")]),n("pre",{class:"language-python"},[n("code",{class:"language-python"},[n("span",{class:"token comment"},"# \u57FA\u672C\u670D\u52A1\u5668\u5B9E\u73B0"),s(`
`),n("span",{class:"token keyword"},"from"),s(" flask "),n("span",{class:"token keyword"},"import"),s(" Flask"),n("span",{class:"token punctuation"},","),s(" request"),n("span",{class:"token punctuation"},","),s(` jsonify
`),n("span",{class:"token keyword"},"import"),s(` llama_cpp

app `),n("span",{class:"token operator"},"="),s(" Flask"),n("span",{class:"token punctuation"},"("),s("__name__"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"# \u52A0\u8F7D\u6A21\u578B"),s(`
llm `),n("span",{class:"token operator"},"="),s(" llama_cpp"),n("span",{class:"token punctuation"},"."),s("Llama"),n("span",{class:"token punctuation"},"("),s(`
    model_path`),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"./qwen2.5-7b-instruct-q4_0.gguf"'),n("span",{class:"token punctuation"},","),s(`
    n_ctx`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"4096"),n("span",{class:"token punctuation"},","),s(`
    n_threads`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"8"),s(`
`),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token decorator annotation punctuation"},[s("@app"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/chat'"),n("span",{class:"token punctuation"},","),s(" methods"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'POST'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"chat"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    data `),n("span",{class:"token operator"},"="),s(" request"),n("span",{class:"token punctuation"},"."),s(`json
    prompt `),n("span",{class:"token operator"},"="),s(" data"),n("span",{class:"token punctuation"},"."),s("get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'prompt'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

    response `),n("span",{class:"token operator"},"="),s(" llm"),n("span",{class:"token punctuation"},"("),s("prompt"),n("span",{class:"token punctuation"},","),s(" max_tokens"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"500"),n("span",{class:"token punctuation"},","),s(" temperature"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"0.7"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" jsonify"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"'response'"),n("span",{class:"token punctuation"},":"),s(" response"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'choices'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'text'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"if"),s(" __name__ "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},"'__main__'"),n("span",{class:"token punctuation"},":"),s(`
    app`),n("span",{class:"token punctuation"},"."),s("run"),n("span",{class:"token punctuation"},"("),s("host"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'0.0.0.0'"),n("span",{class:"token punctuation"},","),s(" port"),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"8000"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("h3",{id:"\u547D\u4EE4\u884C\u5DE5\u5177",tabindex:"-1"},[s("\u547D\u4EE4\u884C\u5DE5\u5177 "),n("a",{class:"header-anchor",href:"#\u547D\u4EE4\u884C\u5DE5\u5177","aria-hidden":"true"},"#")]),n("pre",{class:"language-bash"},[n("code",{class:"language-bash"},[n("span",{class:"token comment"},"# \u4F7F\u7528 llama.cpp \u8F6C\u6362\u6A21\u578B"),s(`
python convert.py `),n("span",{class:"token parameter variable"},"--input"),s(" model.bin "),n("span",{class:"token parameter variable"},"--output"),s(" model.gguf "),n("span",{class:"token parameter variable"},"--type"),s(` q4_0

`),n("span",{class:"token comment"},"# \u4F7F\u7528 ollama \u5FEB\u901F\u90E8\u7F72"),s(`
ollama run qwen:7b
`)])]),n("h2",{id:"\u5DE5\u5177\u4E0E\u751F\u6001",tabindex:"-1"},[s("\u5DE5\u5177\u4E0E\u751F\u6001 "),n("a",{class:"header-anchor",href:"#\u5DE5\u5177\u4E0E\u751F\u6001","aria-hidden":"true"},"#")]),n("h3",{id:"\u4E3B\u8981\u5DE5\u5177",tabindex:"-1"},[s("\u4E3B\u8981\u5DE5\u5177 "),n("a",{class:"header-anchor",href:"#\u4E3B\u8981\u5DE5\u5177","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"llama.cpp"),s("\uFF1A\u539F\u751F C++ \u5B9E\u73B0\uFF0C\u9AD8\u6027\u80FD\u63A8\u7406")]),n("li",null,[n("strong",null,"ollama"),s("\uFF1A\u7528\u6237\u53CB\u597D\u7684\u672C\u5730\u90E8\u7F72\u5DE5\u5177")]),n("li",null,[n("strong",null,"ggml"),s("\uFF1A\u5E95\u5C42\u8BA1\u7B97\u5E93")]),n("li",null,[n("strong",null,"text-generation-webui"),s("\uFF1AWeb \u754C\u9762")])]),n("h3",{id:"\u6A21\u578B\u6765\u6E90",tabindex:"-1"},[s("\u6A21\u578B\u6765\u6E90 "),n("a",{class:"header-anchor",href:"#\u6A21\u578B\u6765\u6E90","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"Hugging Face Hub"),s("\uFF1A\u5B98\u65B9\u6A21\u578B\u4ED3\u5E93")]),n("li",null,[n("strong",null,"TheBloke"),s("\uFF1A\u793E\u533A\u91CF\u5316\u6A21\u578B")]),n("li",null,[n("strong",null,"Chinese-LLaMA-Alpaca"),s("\uFF1A\u4E2D\u6587\u4F18\u5316\u6A21\u578B")])]),n("h2",{id:"\u603B\u7ED3",tabindex:"-1"},[s("\u603B\u7ED3 "),n("a",{class:"header-anchor",href:"#\u603B\u7ED3","aria-hidden":"true"},"#")]),n("h3",{id:"\u4F18\u52BF\u4E0E\u5C40\u9650",tabindex:"-1"},[s("\u4F18\u52BF\u4E0E\u5C40\u9650 "),n("a",{class:"header-anchor",href:"#\u4F18\u52BF\u4E0E\u5C40\u9650","aria-hidden":"true"},"#")]),n("p",null,[n("strong",null,"\u4F18\u52BF\uFF1A")]),n("ul",null,[n("li",null,"\u9AD8\u6548\u538B\u7F29\uFF1A\u901A\u8FC7\u91CF\u5316\u5927\u5E45\u51CF\u5C11\u6A21\u578B\u5927\u5C0F"),n("li",null,"\u5FEB\u901F\u52A0\u8F7D\uFF1A\u5185\u5B58\u6620\u5C04\u6280\u672F\u5B9E\u73B0\u79D2\u7EA7\u52A0\u8F7D"),n("li",null,"\u8DE8\u5E73\u53F0\uFF1A\u7EDF\u4E00\u683C\u5F0F\u652F\u6301\u591A\u79CD\u786C\u4EF6\u5E73\u53F0"),n("li",null,"\u751F\u6001\u4E30\u5BCC\uFF1A\u5B8C\u5584\u7684\u5DE5\u5177\u94FE\u548C\u793E\u533A\u652F\u6301")]),n("p",null,[n("strong",null,"\u5C40\u9650\uFF1A")]),n("ul",null,[n("li",null,"\u7CBE\u5EA6\u635F\u5931\uFF1A\u91CF\u5316\u4F1A\u5E26\u6765\u4E00\u5B9A\u7684\u7CBE\u5EA6\u635F\u5931"),n("li",null,"CPU \u4F18\u5316\uFF1A\u4E3B\u8981\u9488\u5BF9 CPU \u63A8\u7406\u4F18\u5316"),n("li",null,"\u683C\u5F0F\u4F9D\u8D56\uFF1A\u9700\u8981\u4E13\u95E8\u7684\u52A0\u8F7D\u5E93")]),n("h3",{id:"\u76F8\u5173\u8D44\u6E90",tabindex:"-1"},[s("\u76F8\u5173\u8D44\u6E90 "),n("a",{class:"header-anchor",href:"#\u76F8\u5173\u8D44\u6E90","aria-hidden":"true"},"#")]),n("ul",null,[n("li",null,[n("strong",null,"GGUF \u89C4\u8303"),s("\uFF1A"),n("a",{href:"https://github.com/ggml-org/ggml/blob/master/docs/gguf.md",target:"_blank",rel:"noopener"},"Format Specification")]),n("li",null,[n("strong",null,"llama.cpp"),s("\uFF1A"),n("a",{href:"https://github.com/ggml-org/llama.cpp",target:"_blank",rel:"noopener"},"GitHub Repository")]),n("li",null,[n("strong",null,"\u6A21\u578B\u4E0B\u8F7D"),s("\uFF1A"),n("a",{href:"https://huggingface.co/models?library=gguf",target:"_blank",rel:"noopener"},"Hugging Face GGUF Models")])])],-1)])]),_:1})}}};export{_ as date,y as default,b as meta,g as title,f as type};
